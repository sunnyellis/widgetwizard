<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Wizard - Givebutter Support Tool</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/L9OuCoH.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #fff9e6 0%, #fff5cc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .wizard-container {
            width: 450px;
            min-width: 280px;
            max-width: 800px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(255, 191, 0, 0.1);
            border: 2px solid #FFBF00;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .wizard-header {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);
            color: white;
            padding: 15px 20px;
            text-align: center;
            position: relative;
        }

        .wizard-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .wizard-icon {
            width: 40px;
            height: 40px;
            object-fit: contain;
        }

        .wizard-subtitle {
            font-size: 1.1em;
            font-weight: normal;
            opacity: 0.9;
            font-style: italic;
        }

        .header-divider {
            height: 4px;
            background: linear-gradient(135deg, #FFBF00 0%, #FFD700 50%, #FFA500 100%);
            width: 100%;
        }

        .wizard-content {
            flex: 1;
            padding: 20px 30px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            min-height: 200px;
        }

        .step-container {
            display: none;
        }

        .step-container.active {
            display: block !important;
            opacity: 1 !important;
        }

        .step-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .step-description {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .question {
            font-size: 1.0em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .compatibility-header.not-compatible {
            color: #c62828;
        }

        .compatibility-header.compatible {
            color: #2e7d32;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .compatibility-section .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }

        .compatibility-section {
            margin-bottom: 20px;
            display: block;
        }

        .compatibility-header {
            font-size: 0.9em;
            font-weight: 600;
            color: #666;
            margin-bottom: 12px;
            padding-left: 0px;
            width: 100%;
            display: block;
        }

        .option-button {
            background: white;
            border: 2px solid #ddd;
            color: #333;
            padding: 10px 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-button:hover {
            border-color: #FFBF00;
            background: #fff9e6;
            transform: translateY(-1px);
        }

        .option-button.selected {
            border-color: #9c27b0;
            background: #f3e5f5;
            color: #9c27b0;
            font-weight: 600;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1em;
            outline: none;
            margin-bottom: 20px;
        }

        .text-input:focus {
            border-color: #9c27b0;
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
        }

        .large-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 0.9em;
            font-family: monospace;
            outline: none;
            resize: vertical;
            margin-bottom: 20px;
        }

        .large-textarea:focus {
            border-color: #9c27b0;
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
        }

        .checkbox-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-container label {
            cursor: pointer;
            font-weight: 500;
            color: #333;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #9c27b0;
            color: white;
        }

        .btn-primary:hover {
            background: #7b1fa2;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            border: 2px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #bbb;
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .btn-warning {
            background: #FFBF00;
            color: #333;
        }

        .btn-warning:hover {
            background: #e6a600;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #da190b;
            transform: translateY(-1px);
        }

        .alert {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 5px solid;
            font-weight: 500;
        }

        .alert-success {
            background: #e8f5e8;
            border-color: #4CAF50;
            color: #2e7d32;
        }

        .alert-warning {
            background: #fff3cd;
            border-color: #FFBF00;
            color: #856404;
        }

        .alert-danger {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }

        .alert-info {
            background: #e3f2fd;
            border-color: #2196F3;
            color: #1565c0;
        }

        .solution-box {
            background: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .solution-title {
            font-size: 1.0em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
            margin: 15px 0;
        }

        .step-list li {
            counter-increment: step-counter;
            padding: 10px 0;
            padding-left: 40px;
            position: relative;
            border-bottom: 1px solid #eee;
        }

        .step-list li:before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 10px;
            background: #9c27b0;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8em;
        }

        .confidence-builder {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            font-weight: 500;
            color: #2e7d32;
            text-align: center;
        }

        .educational-tip {
            background: #def2de;
            border: 2px solid #a8c8a8;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
            color: #2d5016;
        }

        .educational-tip-structured {
            background: #def2de;
            border: 2px solid #a8c8a8;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: #2d5016;
        }

        .step-header {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #1a3a0d;
        }

        .step-item {
            margin-bottom: 15px;
        }
        
        .platform-instructions {
            background: #f8f9fa;
            border-left: 4px solid #9c27b0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        @media (max-width: 768px) {
            .wizard-container {
                margin: 10px;
                min-height: 90vh;
            }
            
            .wizard-content {
                padding: 20px;
            }
            
            .action-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <div class="wizard-header">
            <div class="wizard-title">
                <img src="https://i.imgur.com/L9OuCoH.png" alt="Magic Wand" class="wizard-icon">
                Widget Wizard
            </div>
            <div class="wizard-subtitle">Guided troubleshooting for widget issues</div>
        </div>

        <div class="header-divider"></div>

        <div class="wizard-content">
            <!-- Welcome Step -->
            <div id="step-welcome" class="step-container active">
                <div class="step-title">üßàü™Ñ Need help with a widget issue? You're in the right place.</div>
                
                <div class="educational-tip">
                    <strong> üîé </strong> This wizard will help you become a widget detective!<br><br>We'll check everything from platform compatibility to code installation, step by step.<br><br>I'll guide you through the same troubleshooting steps our most experienced agents use.
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="nextStep('step-platform')">Let's go! üöÄ</button>
                </div>
            </div>

            <!-- Step 1: Platform Check -->
            <div id="step-platform" class="step-container">
                <div class="step-title">üìã Step 1: Platform Compatibility Check</div>
                <div class="step-description">First, let's make sure we're not churning for nothing! This helps us catch compatibility issues early and save everyone time.</div>
                
                <div class="question">What website builder is your customer using?</div>
                
                <div class="options-container">
                    <button class="option-button" onclick="selectPlatform('wordpress')">
                        <img src="https://i.imgur.com/B6x6Q6g.png" alt="WordPress" style="width: 20px; height: 20px; object-fit: contain;"> WordPress 
                    </button>
                    <button class="option-button" onclick="selectPlatform('squarespace')">
                        <img src="https://i.imgur.com/2tmDKHC.png" alt="Squarespace" style="width: 20px; height: 20px; object-fit: contain;"> Squarespace
                    </button>
                    <button class="option-button" onclick="selectPlatform('wix')">
                        <img src="https://i.imgur.com/yp0GcQp.png" alt="Wix" style="width: 20px; height: 20px; object-fit: contain;"> Wix
                    </button>
                    <button class="option-button" onclick="selectPlatform('godaddy')">
                        <img src="https://i.imgur.com/s3C2cBq.png" alt="GoDaddy" style="width: 20px; height: 20px; object-fit: contain;"> GoDaddy
                    </button>
                    <button class="option-button" onclick="selectPlatform('weebly')">
                        <img src="https://i.imgur.com/Q0wBB3c.png" alt="Weebly" style="width: 20px; height: 20px; object-fit: contain;"> Weebly
                    </button>
                    <button class="option-button" onclick="selectPlatform('google')">
                        <img src="https://i.imgur.com/b3JHWel.png" alt="Google" style="width: 20px; height: 20px; object-fit: contain;"> Google
                    </button>
                    <button class="option-button" onclick="selectPlatform('shopify')">
                        <img src="https://i.imgur.com/xMpCPxC.png" alt="Shopify" style="width: 20px; height: 20px; object-fit: contain;"> Shopify
                    </button>
                    <button class="option-button" onclick="selectPlatform('other')">
                        <span>‚ùì</span> Other (specify)
                    </button>
                </div>

                <div class="checkbox-container" style="display: none;" id="skipCompatibilityCheck">
                    <input type="checkbox" id="skipCheck">
                    <label for="skipCheck">I already confirmed their webbuilder is compatible with Givebutter widgets.</label>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-welcome')">‚Üê Back</button>
                    <button class="btn btn-primary" id="platformContinue" onclick="checkPlatformPlan()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Step 1.2: Plan Level Check -->
            <div id="step-plan-check" class="step-container">
                <div class="step-title">üìã Step 1.2: Plan Level Check</div>
                <div class="step-description" id="planCheckDescription">Let's verify they have the right plan level for widgets.</div>
                
                <div class="question" id="planQuestion">What plan do they have?</div>
                
                <div id="planOptions">
                    <!-- Options will be populated based on platform -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-platform')">‚Üê Back</button>
                    <button class="btn btn-primary" id="planContinue" onclick="checkPlanCompatibility()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Step 2: Widget Type -->
            <div id="step-widget-type" class="step-container">
                <div class="step-title">üéØ Step 2: Widget Type Identification</div>
                <div class="step-description">Different widget types have different requirements - this helps us ask the right questions.</div>
                
                <div class="question">What type of widget is your customer trying to install?</div>
                
                <div class="options-container">
                    <button class="option-button" onclick="selectWidgetType('button')">
                        <img src="https://i.imgur.com/cZB5wbl.png" alt="Button" style="width: 20px; height: 20px; object-fit: contain;"> Button
                    </button>
                    <button class="option-button" onclick="selectWidgetType('form')">
                        <span>üìã</span> Form
                    </button>
                    <button class="option-button" onclick="selectWidgetType('goalbar')">
                        <span>üìä</span> Goal Bar
                    </button>
                    <button class="option-button" onclick="selectWidgetType('signup')">
                        <span>üìß</span> Signup Form
                    </button>
                </div>

                <div class="educational-tip-structured">
                <strong>Important:</strong> Form widgets only embed the donation section - not campaign images, story, or supporter activity. If customers want the full campaign to be embedded, <a href="https://givebutter.canny.io/raise/p/embed-full-campaigns" target="_blank">upvote this feature request</a>.
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goToPreviousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" id="widgetTypeContinue" onclick="handleWidgetTypeSelection()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Step 3: Payout Setup Check -->
            <div id="step-payout-check" class="step-container">
                <div class="step-title">üí∞ Step 3: Payout Setup Check</div>
                <div class="step-description">Great! <span id="platformName"></span> can definitely support widgets.</div>
                
                <div class="question">Have they connected their payout method?</div>
                <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                    Without payout info, widgets appear as blank boxes or load forever.
                </div>
                
                <div class="educational-tip-structured">
                    <strong>üîç How to check:</strong> Click on the payouts tab in the customer's dashboard. Accounts that haven't set up their payout method yet will look like this:

                    <div style="margin-top: 15px;">
                        <img src="https://i.imgur.com/8UWth0V.png" alt="Payout tab location" style="width: 100%; max-width: 400px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <img src="https://i.imgur.com/Zk0gt6s.png" alt="Payout error message" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        </div>
                </div>
                
                <div class="options-container">
                    <button class="option-button" onclick="selectPayoutStatus('connected')">
                        <span>‚úÖ</span> Payouts are setup
                    </button>
                    <button class="option-button" onclick="selectPayoutStatus('not-connected')">
                        <span>‚ùå</span> No payout info
                    </button>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-widget-type')">‚Üê Back</button>
                    <button class="btn btn-primary" id="payoutStatusContinue" onclick="handlePayoutStatus()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Step 3.2: Campaign Published Check -->
            <div id="step-campaign-published" class="step-container">
                <div class="step-title">üü¢ Step 3.2: Campaign Published Check</div>
                
                <div class="question">Is their campaign active?</div>
                <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                    Widgets connected to unpublished campaigns will appear broken. They have nothing to point to.
                </div>
                
                <div class="educational-tip-structured">
    <strong>üîç How to check:</strong> Click on <strong>Campaigns</strong> in the left-hand menu bar. Check the <strong>Status</strong> of the campaign.
    <div style="margin-top: 15px;">
        <img src="https://i.imgur.com/r8QEjaY.png" alt="Campaigns menu location" style="width: 100%; max-width: 196px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <img src="https://i.imgur.com/XqqDn4K.png" alt="Campaign status display" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
    </div>
</div>
                
                <div class="options-container">
                    <button class="option-button" onclick="selectCampaignStatus('published')">
                        <span>üü¢</span> Active
                    </button>
                    <button class="option-button" onclick="selectCampaignStatus('unpublished')">
                        <span>üîò</span> Unpublished
                    </button>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-payout-check')">‚Üê Back</button>
                    <button class="btn btn-primary" id="campaignStatusContinue" onclick="handleCampaignStatus()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Incompatible Plan/Platform -->
            <div id="step-incompatible" class="step-container">
                <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
                    <strong> üòû Darn, widgets won't work with their current setup</strong>
                </div>
                
                <div class="solution-title">üí¨ What to tell your customer:</div>
                <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                     <span id="incompatibleMessage" style="color: #333;"></span>
                    
                    <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                        <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                        <div style="margin-bottom: 8px;">
                            <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                        </div>
                        <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                            https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                        </div>
                        <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-plan-check')">‚Üê Back</button>
                    <button class="btn btn-secondary" onclick="restartWizard()">‚Üê Start Over</button>
                </div>
            </div>

            <!-- Google Incompatible -->
            <div id="step-google-incompatible" class="step-container">
                <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                    <strong> üòû Darn, widgets won't work with their current setup</strong>
                </div>
                
                <div class="solution-title">üí¨ What to tell your customer:</div>
                <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                    <span style="color: #333;">"After checking, I confirmed that Google doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. üòä Would you like directions on how to do that?"</span>
                    
                    <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                        <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                        <div style="margin-bottom: 8px;">
                            <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                        </div>
                        <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                            https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                        </div>
                        <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-platform')">‚Üê Back</button>
                    <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                </div>
            </div>

            <!-- Shopify Incompatible -->
            <div id="step-shopify-incompatible" class="step-container">
                <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                    <strong> üòû Darn, widgets won't work with their current setup</strong>
                </div>
                
                <div class="solution-title">üí¨ What to tell your customer:</div>
                <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                   <span style="color: #333;">"After checking, I confirmed that Shopify doesn't currently support Givebutter widgets. I'll upvote you on our feature request to integrate Shopify with Givebutter. In the meantime - you can still share your campaign link directly on your website and on social media. üòä Would you like directions on how to do that?"</span> 
                    
                   <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal; font-size: 1.1em;">Additional Resources</div>
                
                <div style="margin-bottom: 15px;">
                    <div style="margin-bottom: 8px;">
                        <a href="https://givebutter.canny.io/integration-requests/p/shopify-integration" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">Shopify Canny Request</a>
                    </div>
                    <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                        https://givebutter.canny.io/integration-requests/p/shopify-integration
                    </div>
                </div>
                
                <div style="margin-bottom: 8px;">
                    <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">Help Article: How to share a campaign</a>
                </div>
                <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                    https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                </div>
                <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                    Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                </div>
            </div>
            </div>

            <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-platform')">‚Üê Back</button>
                    <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                </div>
            </div> 

            <!-- Other Platform Research -->
            <div id="step-other-research" class="step-container">
                <div style="color: #333; font-size: 1.0em; margin-bottom: 25px;">
                    <strong>Looks like we don't have any documentation about widgets and <span id="otherPlatformNameDisplay">[PLATFORM NAME]</span></strong>
                </div>
                
                <div class="educational-tip-structured">
                <div class="step-header">Don't panic, we can still help!</div>
                
                <div class="step-item">
                    <strong>üîç Research Step:</strong> Ask ChatGPT: "Does <span id="otherPlatformNameChatGPT">[PLATFORM NAME]</span> support code injection?"
                </div>
                
                <div class="step-item">
                    <strong>üìã What you'll get:</strong> A summary of whether Givebutter Widgets work with <span class="otherPlatformName">[PLATFORM NAME]</span> and any plan requirements
                </div>
                
                <div class="step-item">
                    <strong>ü§î Your decision:</strong> Is their <span class="otherPlatformName">[PLATFORM NAME]</span> plan compatible with Givebutter widgets?
                </div>
            </div>

            <div class="options-container">
                <button class="option-button" onclick="selectCompatibility('not-compatible')">
                    ‚ùå Not Compatible
                </button>
                <button class="option-button" onclick="selectCompatibility('compatible')">
                    ‚úÖ Compatible
                </button>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="previousStep('step-platform')">‚Üê Back</button>
                <button class="btn btn-primary" id="compatibilityContinue" onclick="handleCompatibilitySelection()" disabled>Continue ‚Üí</button>
            </div>
            </div>

            <!-- Generic Platform Incompatible -->
            <div id="step-generic-incompatible" class="step-container">
                <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                    <strong> üòû Darn, widgets won't work with their current setup</strong>
                </div>
                
                <div class="solution-title">üí¨ What to tell your customer:</div>
                <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                    <span style="color: #333;" id="genericIncompatibleMessage">"After checking, I confirmed that [PLATFORM NAME] doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. üòä Would you like directions on how to do that?"</span>
                    
                    <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                        <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                        <div style="margin-bottom: 8px;">
                            <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                        </div>
                        <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                            https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                        </div>
                        <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-other-research')">‚Üê Back</button>
                    <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                </div>
            </div>

            <!-- No Payout Solution -->
           <div id="step-payout-solution" class="step-container">
    <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
        <strong>üéâ Another common culprit! This could be the cause.</strong>
    </div>
    
    <div class="solution-title">üí¨ What to tell your customer:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
        <span style="color: #333;">"Ah, it looks like you still need to connect your payout information. That has to be completed before widgets can work. Here are instructions on how to do that."</span>
        
        <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
            <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
            <div style="margin-bottom: 8px;">
                <a href="https://help.givebutter.com/en/articles/10401823-how-to-add-and-edit-your-payout-information-with-stripe-connect" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to add and edit your payout information with Stripe Connect</a>
            </div>
            <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                https://help.givebutter.com/en/articles/10401823-how-to-add-and-edit-your-payout-information-with-stripe-connect
            </div>
            <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                üïµÔ∏è Most agents miss this step - you caught it!
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="previousStep('step-payout-check')">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep('step-campaign-published')">Continue ‚Üí</button>
    </div>
</div>

            <!-- Campaign Not Published Solution -->
            <div id="step-unpublished-solution" class="step-container">
    <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
        <strong>This is probably why the widget isn't working.</strong>
    </div>
    
    <div class="solution-title">üí¨ What to tell your customer:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
        <span style="color: #333;">"I found the issue! Your campaign needs to be published before the widget can work. Let's get that published, and see if your widget starts working properly."</span>
        
        <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
            <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">üìù Steps to share:</div>
            <div style="color: #333; line-height: 1.5;">
                <strong>1.</strong> Go to your campaign in your dashboard. On the top right corner, click the blue button that says "Publish"<br>
                <strong>2.</strong> The "Unpublished" label should disappear<br>
                <strong>3.</strong> Try your widget again!
            </div>
            <img src="https://i.imgur.com/9zoPDFp.png" alt="Widget working example" style="width: 100%; max-width: 400px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em; margin-top: 15px;">
                üéØ You're doing great! This is exactly the right approach!
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="previousStep('step-campaign-published')">‚Üê Back</button>
        <button class="btn btn-primary" onclick="nextStep('step-code-collection')">Continue ‚Üí</button>
    </div>
</div>

            <!-- Step 4: Code Collection -->
            <div id="step-code-collection" class="step-container">
                <div class="step-title">üìù Step 4: Code Collection</div>
                
                <div class="educational-tip">
                    <strong>üïµÔ∏è Time for some detective work!</strong> There are two pieces of code for each widget: the library code and the widget code. We need to confirm that both pieces of code are installed on the user's website.
                </div>
                
                <div class="alert alert-info">
                    <strong>üß† Widget Education Moment:</strong> Think of widgets like a car - you need both the ENGINE (library code) and the STEERING WHEEL (widget code) to get anywhere. Lots of people install one but forget the other!
                </div>
                
                <div style="color: #666; margin-bottom: 20px;">
                    Sometimes, the Givebutter dashboard says the library is installed when it's actually not. Only check the button below if you have manually confirmed the library code is present on the user's website.
                </div>
                
                <div class="checkbox-container">
                    <input type="checkbox" id="libraryConfirmed" onchange="toggleLibraryConfirmed()">
                    <label for="libraryConfirmed">‚úÖ I already confirmed they have the library code installed</label>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goToPreviousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep('step-library-check')">Check Library Code ‚Üí</button>
                    <button class="btn btn-warning" id="skipToWidget" onclick="nextStep('step-widget-check')" style="display: none;">Skip to Widget Check ‚Üí</button>
                </div>
            </div>

            <!-- Library Code Check -->
            <div id="step-library-check" class="step-container">
                <div class="step-title">üìö Step 4.1: Library Code Detection</div>
                <div class="step-description">First, let's check if they installed their library code.</div>
                
                <div class="question">What's the website URL where the widget should appear?</div>
                <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                    Make sure this is the exact page URL they want the widget on, not just their home page.
                </div>
                
                <input type="text" class="text-input" id="websiteUrl" placeholder="https://example.com/donate" onkeyup="checkUrlInput()">

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-code-collection')">‚Üê Back</button>
                    <button class="btn btn-primary" id="urlContinue" onclick="startLibraryInspection()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Library Inspection Steps -->
            <div id="step-library-inspection" class="step-container">
                <div class="step-title">üîç Library Code Inspection</div>
                
                <div class="solution-box">
                    <div class="solution-title">üìù Instructions for you:</div>
                    <ol class="step-list">
                        <li>Go to <strong id="inspectionUrl"></strong></li>
                        <li>Right-click anywhere on the page and select "Inspect" or "Inspect Element" (or press F12)</li>
                        <li>Press Ctrl+F (or Cmd+F on Mac) to open the search box</li>
                        <li>Search for: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px;">latest.umd.cjs</code></li>
                    </ol>
                </div>
                
                <div class="question">Does anything highlight in yellow or show up in the search results?</div>
                <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                    Leave this page and search box open, we might need it again in a minute.
                </div>
                
                <div class="options-container">
                    <button class="option-button" onclick="selectLibraryFound('found')">
                        <span>‚úÖ</span> Found it! Something highlighted
                    </button>
                    <button class="option-button" onclick="selectLibraryFound('not-found')">
                        <span>‚ùå</span> Nothing found / No results
                    </button>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-library-check')">‚Üê Back</button>
                    <button class="btn btn-primary" id="libraryFoundContinue" onclick="handleLibraryResult()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Library Not Found - Install Instructions -->
            <div id="step-library-install" class="step-container">
                <div class="step-title">üìù Library Code Installation</div>
                
                <div class="alert alert-warning">
                    <strong>Aha! The library code is missing.</strong> Let's get that fixed! Remember, even if the Givebutter dashboard says the library is installed, that might not be true!
                </div>
                
                <div class="solution-box">
                    <div class="solution-title">üó£Ô∏è Tell your customer:</div>
                    <div class="code-block">"I double-checked your website, and I see the library code isn't installed yet. Let's get that taken care of. I'd be happy to walk you through step-by-step right now, or I can send you the instructions for that part. What would you like to do?"</div>
                    
                    <div style="color: #666; font-style: italic; margin-top: 15px;">
                        Installing code can be intimidating for many users, so it's important not to send a help article right away without first checking in. When someone reaches out to us, it's because they're looking for guidance‚Äînot just information. Giving them this choice empowers them to decide what will help them most.
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-library-inspection')">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep('step-get-library-code')">Step-by-step help</button>
                    <button class="btn btn-warning" onclick="nextStep('step-widget-check')">Sending article, let's check the widget</button>
                    <button class="btn btn-danger" onclick="exitWizard()">Exit wizard</button>
                </div>
            </div>

            <!-- Get Library Code -->
            <div id="step-get-library-code" class="step-container">
                <div class="step-title">üìã Get Their Library Code</div>
                
                <div class="solution-box">
                    <div class="solution-title">üìù Since we already know which campaign this is for:</div>
                    <ol class="step-list">
                        <li>Go to the campaign in their dashboard</li>
                        <li>Go to the sharing tab</li>
                        <li>Click "Installation" and choose <strong id="selectedPlatformName"></strong></li>
                        <li>Copy the entire code that contains <code>https://widgets.givebutter.com/latest</code></li>
                    </ol>
                </div>
                
                <div class="question">üìã Paste their library code here:</div>
                <textarea class="large-textarea" id="libraryCode" placeholder="Paste the library code here..." onkeyup="checkLibraryCode()"></textarea>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-library-install')">‚Üê Back</button>
                    <button class="btn btn-primary" id="libraryCodeContinue" onclick="showPlatformInstructions()" disabled>Continue ‚Üí</button>
                </div>
            </div>

            <!-- Platform Installation Instructions -->
            <div id="step-platform-instructions" class="step-container">
                <div class="step-title">üîß Platform Installation Instructions</div>
                
                <div class="solution-box">
                    <div class="solution-title">üó£Ô∏è Tell your customer:</div>
                    <div class="platform-instructions" id="platformInstructionsContent">
                        <!-- Content will be populated based on platform -->
                    </div>
                    
                    <div class="solution-title">üìù Library Code to Install:</div>
                    <div class="code-block" id="libraryCodeDisplay"></div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="previousStep('step-get-library-code')">‚Üê Back</button>
                    <button class="btn btn-success" onclick="markProblemSolved('library-installed')">Done, that solved the issue!</button>
                    <button class="btn btn-warning" onclick="nextStep('step-widget-check')">Done, now let's work on the widget code</button>
                    <button class="btn btn-danger" onclick="exitWizard()">Exit</button>
                </div>
            </div>

            <!-- Problem Solved -->
            <div id="step-problem-solved" class="step-container">
                <div class="alert alert-success">
                    <strong>üéâ Fantastic! You're really turning into a Widget expert!</strong>
                </div>
                
                <div class="confidence-builder">
                    üßà You successfully diagnosed and solved the widget issue! The customer should now have a working widget on their website.
                </div>
                
                <div class="solution-box">
                    <div class="solution-title">‚úÖ What was solved:</div>
                    <div id="solutionSummary"></div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="restartWizard()">Help another widget issue üîÑ</button>
                    <button class="btn btn-secondary" onclick="exitWizard()">Return to SALT</button>
                </div>
            </div>

            <!-- Widget Check (Placeholder for now) -->
            <div id="step-widget-check" class="step-container">
                <div class="step-title">üìù Step 4.2: Widget Code Check</div>
                <div class="step-description">Now let's check if the widget code itself is installed...</div>
                
                <div class="alert alert-info">
                    <strong>üöß Coming Soon:</strong> This section is still being built out. For now, you can use the knowledge from the previous steps to guide the customer through widget code installation.
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goToPreviousStep()">‚Üê Back</button>
                    <button class="btn btn-success" onclick="markProblemSolved('manual-completion')">Mark as resolved (manual)</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentStep = 'step-welcome';
        let wizardData = {
            platform: null,
            plan: null,
            widgetType: null,
            payoutStatus: null,
            campaignStatus: null,
            websiteUrl: null,
            libraryCode: null,
            libraryFound: null,
            compatibilityStatus: null
        };

        const stepOrder = [
            'step-welcome',
            'step-platform', 
            'step-plan-check',
            'step-widget-type',
            'step-payout-check',
            'step-campaign-published',
            'step-code-collection',
            'step-library-check',
            'step-library-inspection'
        ];

        // Navigation functions
        function nextStep(stepId) {
            document.getElementById(currentStep).classList.remove('active');
            document.getElementById(stepId).classList.add('active');
            currentStep = stepId;
            updateNavButtons();
        }

        function previousStep(stepId) {
            document.getElementById(currentStep).classList.remove('active');
            document.getElementById(stepId).classList.add('active');
            currentStep = stepId;
            updateNavButtons();
        }

        function goToPreviousStep() {
            const currentIndex = stepOrder.indexOf(currentStep);
            if (currentIndex > 0) {
                previousStep(stepOrder[currentIndex - 1]);
            }
        }

        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const currentIndex = stepOrder.indexOf(currentStep);
            if (prevBtn) {
                prevBtn.disabled = (currentIndex <= 0 || currentStep === 'step-welcome');
            }
        }

        function restartWizard() {
            wizardData = {
                platform: null,
                plan: null,
                widgetType: null,
                payoutStatus: null,
                campaignStatus: null,
                websiteUrl: null,
                libraryCode: null,
                libraryFound: null,
                compatibilityStatus: null
            };
            nextStep('step-welcome');
        }

        function exitWizard() {
            if (confirm('Are you sure you want to exit the Widget Wizard?')) {
                alert('üëã Thanks for using the Widget Wizard! You\'ll return to the main SALT interface.');
            }
        }

        // Platform selection functions
        function selectPlatform(platform) {
            document.querySelectorAll('#step-platform .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            const button = event.target.closest('.option-button');
            if (button) {
                button.classList.add('selected');
            }
            wizardData.platform = platform;
            
            document.getElementById('platformContinue').disabled = false;

            if (['wordpress', 'squarespace', 'wix', 'godaddy', 'weebly'].includes(platform)) {
                document.getElementById('skipCompatibilityCheck').style.display = 'flex';
            }
        }

        function checkPlatformPlan() {
            if (wizardData.platform === 'other') {
                const platformName = prompt('What website builder are they using?');
                if (platformName) {
                    wizardData.otherPlatformName = platformName;
                    
                    document.getElementById('otherPlatformNameDisplay').textContent = platformName;
                    document.getElementById('otherPlatformNameChatGPT').textContent = platformName;
                    document.querySelectorAll('.otherPlatformName').forEach(span => {
                        span.textContent = platformName;
                    });
                    
                    nextStep('step-other-research');
                    return;
                }
            }

            if (wizardData.platform === 'google') {
                nextStep('step-google-incompatible');
                return;
            }
            
            if (wizardData.platform === 'shopify') {
                nextStep('step-shopify-incompatible');
                return;
            }

            if (wizardData.platform === 'weebly' || wizardData.platform === 'godaddy') {
                nextStep('step-widget-type');
                return;
            }
            
            const skipCheck = document.getElementById('skipCheck');
            if (skipCheck && skipCheck.checked) {
                nextStep('step-widget-type');
                return;
            }
            
            setupPlanCheck();
            nextStep('step-plan-check');
        }

        function showIncompatibleFromResearch() {
            const platformName = wizardData.otherPlatformName;
            document.getElementById('genericIncompatibleMessage').textContent = 
                `"After checking, I confirmed that ${platformName} doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. üòä Would you like directions on how to do that?"`;
            nextStep('step-generic-incompatible');
        }

        function setupPlanCheck() {
            const planOptions = document.getElementById('planOptions');
            const planQuestion = document.getElementById('planQuestion');
            const planDescription = document.getElementById('planCheckDescription');
            
            planOptions.innerHTML = '';
            
            switch (wizardData.platform) {
                case 'wordpress':
                    planQuestion.textContent = 'What WordPress plan do they have?';
                    planDescription.textContent = 'Widgets need the ability to install plugins or add custom code.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                                <button class="option-button" onclick="selectPlan('personal')">
                                    Personal plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('business')">
                                    Business plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('ecommerce')">
                                    eCommerce plan
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'squarespace':
                    planQuestion.textContent = 'What Squarespace plan do they have?';
                    planDescription.textContent = 'Widgets need Code Injection access.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('basic')">
                                    Basic plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('core')">
                                    Core plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('plus')">
                                    Plus plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('advanced')">
                                    Advanced plan
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'wix':
                    planQuestion.textContent = 'Do they have a premium Wix plan with a custom domain (no ads)?';
                    planDescription.textContent = 'Widgets need the Custom Element feature.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('light')">
                                    Light plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('core')">
                                    Core plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('business')">
                                    Business plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('businesselite')">
                                    Business Elite plan
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    planQuestion.textContent = 'What plan level do they have?';
                    planDescription.textContent = 'Let\'s verify they have the right plan for custom code.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('premium')">
                                    Premium/Paid plan
                                </button>
                            </div>
                        </div>
                    `;
            }
        }

        function selectPlan(plan) {
            document.querySelectorAll('#step-plan-check .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            const buttons = document.querySelectorAll('#step-plan-check .option-button');
            buttons.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(plan.toLowerCase()) || 
                    (plan === 'business' && btn.textContent.includes('Business')) ||
                    (plan === 'ecommerce' && btn.textContent.includes('eCommerce')) ||
                    (plan === 'personal' && btn.textContent.includes('Personal')) ||
                    (plan === 'free' && btn.textContent.includes('Free')) ||
                    (plan === 'premium' && btn.textContent.includes('Premium'))) {
                    btn.classList.add('selected');
                }
            });
            
            wizardData.plan = plan;
            document.getElementById('planContinue').disabled = false;
        }

        function checkPlanCompatibility() {
            const selectedButton = document.querySelector('#step-plan-check .option-button.selected');
            
            if (!selectedButton) {
                console.error('No plan selected!');
                return;
            }
            
            const isCompatible = selectedButton.classList.contains('compatible');
            
            if (isCompatible) {
                nextStep('step-widget-type');
            } else {
                showIncompatible();
            }
        }
        
        function showIncompatible() {
            const incompatibleMessage = document.getElementById('incompatibleMessage');
            const platformName = getPlatformDisplayName(wizardData.platform);
            
            if (['free', 'personal', 'basic'].includes(wizardData.plan)) {
                const requiredPlan = getRequiredPlan(wizardData.platform);
                incompatibleMessage.textContent = `"After checking, it looks like you need to be on the ${requiredPlan} plan with ${platformName} to use Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. üòä Would you like directions on how to do that?"`;
            }
            
            nextStep('step-incompatible');
        }
        
        function getPlatformDisplayName(platform) {
            const names = {
                'wordpress': 'WordPress',
                'squarespace': 'Squarespace',
                'wix': 'Wix',
                'godaddy': 'GoDaddy',
                'weebly': 'Weebly',
                'google': 'Google',
                'shopify': 'Shopify'
            };
            return names[platform] || platform;
        }

        function getRequiredPlan(platform) {
            const plans = {
                'wordpress': 'Business or eCommerce',
                'squarespace': 'Core, Plus, or Advanced',
                'wix': 'Light, Core, Business, or Business Elite'
            };
            return plans[platform] || 'Premium';
        }

        // Widget type selection
        function selectWidgetType(type) {
            document.querySelectorAll('#step-widget-type .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.widgetType = type;
            document.getElementById('widgetTypeContinue').disabled = false;
        }

        function handleWidgetTypeSelection() {
            if (wizardData.widgetType === 'signup') {
                nextStep('step-code-collection');
            } else {
       // Set platform name (handles both regular platforms and "other")
        const displayName = wizardData.platform === 'other' ? 
            wizardData.otherPlatformName : 
            getPlatformDisplayName(wizardData.platform);
        document.getElementById('platformName').textContent = displayName;
        nextStep('step-payout-check');
    }
}

        // Payout status functions
        function selectPayoutStatus(status) {
            document.querySelectorAll('#step-payout-check .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.payoutStatus = status;
            document.getElementById('payoutStatusContinue').disabled = false;
        }

        function handlePayoutStatus() {
            if (wizardData.payoutStatus === 'not-connected') {
                nextStep('step-payout-solution');
            } else {
                nextStep('step-campaign-published');
            }
        }

        // Campaign status functions
        function selectCampaignStatus(status) {
            document.querySelectorAll('#step-campaign-published .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.campaignStatus = status;
            document.getElementById('campaignStatusContinue').disabled = false;
        }

        function handleCampaignStatus() {
            if (wizardData.campaignStatus === 'unpublished') {
                nextStep('step-unpublished-solution');
            } else {
                nextStep('step-code-collection');
            }
        }

        // Compatibility selection functions
        function selectCompatibility(status) {
            document.querySelectorAll('#step-other-research .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.compatibilityStatus = status;
            document.getElementById('compatibilityContinue').disabled = false;
        }

        function handleCompatibilitySelection() {
            if (wizardData.compatibilityStatus === 'compatible') {
                document.getElementById('platformName').textContent = wizardData.otherPlatformName;
                nextStep('step-widget-type');
            } else {
                showIncompatibleFromResearch();
            }
        }

        // Library code functions
        function toggleLibraryConfirmed() {
            const checkbox = document.getElementById('libraryConfirmed');
            const skipButton = document.getElementById('skipToWidget');
            
            if (checkbox.checked) {
                skipButton.style.display = 'inline-flex';
            } else {
                skipButton.style.display = 'none';
            }
        }

        function checkUrlInput() {
            const url = document.getElementById('websiteUrl').value.trim();
            const continueBtn = document.getElementById('urlContinue');
            
            if (url && url.startsWith('http')) {
                continueBtn.disabled = false;
            } else {
                continueBtn.disabled = true;
            }
        }

        function startLibraryInspection() {
            wizardData.websiteUrl = document.getElementById('websiteUrl').value.trim();
            document.getElementById('inspectionUrl').textContent = wizardData.websiteUrl;
            nextStep('step-library-inspection');
        }

        function selectLibraryFound(status) {
            document.querySelectorAll('#step-library-inspection .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.libraryFound = status;
            document.getElementById('libraryFoundContinue').disabled = false;
        }

        function handleLibraryResult() {
            if (wizardData.libraryFound === 'found') {
                nextStep('step-widget-check');
            } else {
                nextStep('step-library-install');
            }
        }

        function checkLibraryCode() {
            const code = document.getElementById('libraryCode').value.trim();
            const continueBtn = document.getElementById('libraryCodeContinue');
            
            if (code && code.includes('widgets.givebutter.com')) {
                continueBtn.disabled = false;
                wizardData.libraryCode = code;
            } else {
                continueBtn.disabled = true;
            }
        }

        function showPlatformInstructions() {
            const platform = wizardData.platform;
            const instructionsContent = document.getElementById('platformInstructionsContent');
            const libraryCodeDisplay = document.getElementById('libraryCodeDisplay');
            
            document.getElementById('selectedPlatformName').textContent = getPlatformDisplayName(platform);
            libraryCodeDisplay.textContent = wizardData.libraryCode;
            
            let instructions = '';
            switch (platform) {
                case 'squarespace':
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        1. Click on the <strong>Website</strong> heading in your Squarespace account.<br>
                        2. Scroll down, and under the <strong>Utilities</strong> heading, click <strong>Website Tools</strong>.<br>
                        3. Click <strong>Code Injection</strong>.<br>
                        4. Under the <strong>Header</strong> section, paste the library code below, and save.
                    `;
                    break;
                    
                case 'wordpress':
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        1. Download and install the Givebutter WordPress plugin.<br>
                        2. Go to your WordPress admin dashboard.<br>
                        3. Navigate to the Givebutter plugin settings.<br>
                        4. Enter your Givebutter account ID and save.
                    `;
                    break;
                    
                case 'wix':
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        1. Go to your Wix editor.<br>
                        2. Click on the <strong>+</strong> button to add elements.<br>
                        3. Go to <strong>Embed</strong> and select <strong>Custom Element</strong>.<br>
                        4. Paste the library code in the HTML settings.
                    `;
                    break;
                    
                case 'godaddy':
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        1. Log in to your GoDaddy account.<br>
                        2. Scroll to Websites + Marketing and select Manage next to your website.<br>
                        3. Select Edit Website or Edit Site to open your website builder.<br>
                        4. Go to the page and location you want to add your custom code, and add a section.<br>
                        5. Search for HTML section and select Add. Paste the code below in the Custom Code field.
                    `;
                    break;
                    
                case 'weebly':
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        1. Log in to your Weebly account.<br>
                        2. Navigate to Settings > SEO > Header code.<br>
                        3. Copy and paste the code below in the Header Type text field.
                    `;
                    break;
                    
                default:
                    instructions = `
                        <em>To install the library on your webpage:</em><br>
                        Please refer to your website builder's documentation for adding custom HTML/JavaScript code to the header section of your site.
                    `;
            }
            
            instructionsContent.innerHTML = instructions;
            nextStep('step-platform-instructions');
        }

        function markProblemSolved(solutionType) {
            const solutionSummary = document.getElementById('solutionSummary');
            
            let summary = '';
            switch (solutionType) {
                case 'campaign-published':
                    summary = 'Campaign was unpublished - guided customer to publish their campaign.';
                    break;
                case 'payout-connected':
                    summary = 'Payout method was not connected - provided customer with payout setup instructions.';
                    break;
                case 'library-installed':
                    summary = `Library code was missing - provided ${getPlatformDisplayName(wizardData.platform)}-specific installation instructions.`;
                    break;
                case 'manual-completion':
                    summary = 'Issue resolved through manual troubleshooting steps.';
                    break;
                default:
                    summary = 'Widget issue successfully resolved!';
            }
            
            solutionSummary.textContent = summary;
            nextStep('step-problem-solved');
        }

        // Initialize wizard
        updateNavButtons();
    </script>
</body>
</html>
