<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Wizard - Givebutter Support Tool</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/L9OuCoH.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #fff9e6 0%, #fff5cc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-x: auto;
        }

        .main-container {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 1200px;
            align-items: flex-start;
            justify-content: center;
        }

        .wizard-container {
            width: 450px;
            min-width: 280px;
            max-width: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(255, 191, 0, 0.1);
            border: 2px solid #FFBF00;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .checklist-container {
            width: 150px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(156, 39, 176, 0.1);
            border: 2px solid #9c27b0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 20px;
            flex-shrink: 0;
        }

        .wizard-header, .checklist-header {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);
            color: white;
            padding: 15px 20px;
            text-align: center;
            position: relative;
        }

        .checklist-header {
            padding: 15px 10px;
        }

        .wizard-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .checklist-title {
            font-size: 1.2em;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .wizard-icon {
            width: 40px;
            height: 40px;
            object-fit: contain;
        }

        .wizard-subtitle {
            font-size: 1.1em;
            font-weight: normal;
            opacity: 0.9;
            font-style: italic;
        }

        .header-divider, .checklist-header-divider {
            height: 4px;
            background: linear-gradient(135deg, #FFBF00 0%, #FFD700 50%, #FFA500 100%);
            width: 100%;
        }

        .checklist-header-divider {
            background: linear-gradient(135deg, #9c27b0 0%, #673ab7 50%, #512da8 100%);
        }

        .wizard-content {
            flex: 1;
            padding: 20px 30px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            min-height: 200px;
        }

        .checklist-content {
            padding: 10px 8px;
        }

        .step-container {
            display: none;
        }

        .step-container.active {
            display: block !important;
            opacity: 1 !important;
        }

        .step-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .step-description {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .question {
            font-size: 1.0em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .compatibility-header.not-compatible {
            color: #c62828;
        }

        .compatibility-header.compatible {
            color: #2e7d32;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .compatibility-section .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }

        .compatibility-section {
            margin-bottom: 20px;
            display: block;
        }

        .compatibility-header {
            font-size: 0.9em;
            font-weight: 600;
            color: #666;
            margin-bottom: 12px;
            padding-left: 0px;
            width: 100%;
            display: block;
        }

        .option-button {
            background: white;
            border: 2px solid #ddd;
            color: #333;
            padding: 10px 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-button:hover {
            border-color: #FFBF00;
            background: #fff9e6;
            transform: translateY(-1px);
        }

        .option-button.selected {
            border-color: #9c27b0;
            background: #f3e5f5;
            color: #9c27b0;
            font-weight: 600;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1em;
            outline: none;
            margin-bottom: 20px;
        }

        .text-input:focus {
            border-color: #9c27b0;
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
        }

        .large-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 0.9em;
            font-family: monospace;
            outline: none;
            resize: vertical;
            margin-bottom: 20px;
        }

        .large-textarea:focus {
            border-color: #9c27b0;
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
        }

        .checkbox-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-container label {
            cursor: pointer;
            font-weight: 500;
            color: #333;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #9c27b0;
            color: white;
        }

        .btn-primary:hover {
            background: #7b1fa2;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            border: 2px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #bbb;
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .btn-warning {
            background: #FFBF00;
            color: #333;
        }

        .btn-warning:hover {
            background: #e6a600;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #da190b;
            transform: translateY(-1px);
        }

        .alert {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 5px solid;
            font-weight: 500;
        }

        .alert-success {
            background: #e8f5e8;
            border-color: #4CAF50;
            color: #2e7d32;
        }

        .alert-warning {
            background: #fff3cd;
            border-color: #FFBF00;
            color: #856404;
        }

        .alert-danger {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }

        .alert-info {
            background: #e3f2fd;
            border-color: #2196F3;
            color: #1565c0;
        }

        .solution-box {
            background: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .solution-title {
            font-size: 1.0em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
            margin: 15px 0;
        }

        .step-list li {
            counter-increment: step-counter;
            padding: 10px 0;
            padding-left: 40px;
            position: relative;
            border-bottom: 1px solid #eee;
        }

        .step-list li:before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 10px;
            background: #9c27b0;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8em;
        }

        .confidence-builder {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            font-weight: 500;
            color: #2e7d32;
            text-align: center;
        }

        .educational-tip {
            background: #def2de;
            border: 2px solid #a8c8a8;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
            color: #2d5016;
        }

        .educational-tip-structured {
            background: #def2de;
            border: 2px solid #a8c8a8;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: #2d5016;
        }

        .step-header {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #1a3a0d;
        }

        .step-item {
            margin-bottom: 15px;
        }
        
        .platform-instructions {
            background: #f8f9fa;
            border-left: 4px solid #9c27b0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        /* Checklist Styles */
        .checklist-item {
            display: flex;
            flex-direction: column;
            padding: 6px 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.8em;
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
            font-size: 0.8em;
            line-height: 1.1;
        }

        .checklist-value {
            color: #666;
            font-family: monospace;
            font-size: 0.7em;
            word-break: break-all;
            line-height: 1.1;
        }

        .checklist-status {
            font-size: 1em;
        }

        .status-pending {
            color: #666;
        }

        .status-complete {
            color: #4CAF50;
        }

        .status-dynamic {
            color: #2196F3;
            font-weight: 600;
        }

        .checklist-item.wordpress-only {
            background: linear-gradient(90deg, #e3f2fd 0%, #f8f9fa 100%);
            border-radius: 4px;
            padding: 6px 8px;
            margin: 2px 0;
            border: 1px solid #e1f5fe;
        }

        .checklist-item.wix-only {
            background: linear-gradient(90deg, #f3e5f5 0%, #f8f9fa 100%);
            border-radius: 4px;
            padding: 6px 8px;
            margin: 2px 0;
            border: 1px solid #e1bee7;
        }

        .platform-specific-label {
            font-size: 0.65em;
            color: #666;
            font-style: italic;
            margin-left: 2px;
        }

        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
                align-items: center;
            }

            .checklist-container {
                width: 450px;
                position: relative;
                top: 0;
            }
        }

        @media (max-width: 768px) {
            .wizard-container, .checklist-container {
                margin: 10px;
                min-height: 90vh;
            }
            
            .wizard-content, .checklist-content {
                padding: 20px;
            }
            
            .action-buttons {
                justify-content: center;
            }
            .shortcode-input {
                width: 100%;
                height: 50px;
                padding: 15px;
                border: 2px solid #ddd;
                border-radius: 12px;
                font-size: 0.9em;
                font-family: monospace;
                outline: none;
                margin-bottom: 20px;
            }

            .shortcode-input:focus {
                border-color: #9c27b0;
                box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
            }
        }        
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Main Wizard Container -->
        <div class="wizard-container">
            <div class="wizard-header">
                <div class="wizard-title">
                    <img src="https://i.imgur.com/L9OuCoH.png" alt="Magic Wand" class="wizard-icon">
                    Widget Wizard
                </div>
                <div class="wizard-subtitle">Guided troubleshooting for widget issues</div>
            </div>

            <div class="header-divider"></div>

            <div class="wizard-content">
                <!-- Welcome Step -->
                <div id="step-welcome" class="step-container active">
                    <div class="step-title">🧈🪄 Need help with a widget issue? You're in the right place.</div>
                    
                    <div class="educational-tip">
                        <strong> 🔎 </strong> This wizard will help you become a widget detective!<br><br>We'll check everything from platform compatibility to code installation, step-by-step.<br><br>I'll guide you through the same troubleshooting steps our most experienced agents use.
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="nextStep('step-platform')">Let's go! 🚀</button>
                    </div>
                </div>

                <!-- Step 1: Platform Check -->
                <div id="step-platform" class="step-container">
                    <div class="step-title">📋 Step 1: Platform Compatibility Check</div>
                    <div class="step-description">First, let's make sure we're not churning for nothing! This helps us catch compatibility issues early and save everyone time.</div>
                    
                    <div class="question">What website builder is your User using?</div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectPlatform('wordpress')">
                            <img src="https://i.imgur.com/B6x6Q6g.png" alt="WordPress" style="width: 20px; height: 20px; object-fit: contain;"> WordPress 
                        </button>
                        <button class="option-button" onclick="selectPlatform('squarespace')">
                            <img src="https://i.imgur.com/2tmDKHC.png" alt="Squarespace" style="width: 20px; height: 20px; object-fit: contain;"> Squarespace
                        </button>
                        <button class="option-button" onclick="selectPlatform('wix')">
                            <img src="https://i.imgur.com/yp0GcQp.png" alt="Wix" style="width: 20px; height: 20px; object-fit: contain;"> Wix
                        </button>
                        <button class="option-button" onclick="selectPlatform('godaddy')">
                            <img src="https://i.imgur.com/s3C2cBq.png" alt="GoDaddy" style="width: 20px; height: 20px; object-fit: contain;"> GoDaddy
                        </button>
                        <button class="option-button" onclick="selectPlatform('weebly')">
                            <img src="https://i.imgur.com/Q0wBB3c.png" alt="Weebly" style="width: 20px; height: 20px; object-fit: contain;"> Weebly
                        </button>
                        <button class="option-button" onclick="selectPlatform('google')">
                            <img src="https://i.imgur.com/b3JHWel.png" alt="Google" style="width: 20px; height: 20px; object-fit: contain;"> Google
                        </button>
                        <button class="option-button" onclick="selectPlatform('shopify')">
                            <img src="https://i.imgur.com/xMpCPxC.png" alt="Shopify" style="width: 20px; height: 20px; object-fit: contain;"> Shopify
                        </button>
                        <button class="option-button" onclick="selectPlatform('other')">
                            <span>❓</span> Other (specify)
                        </button>
                    </div>

                    <div class="checkbox-container" style="display: none;" id="skipCompatibilityCheck">
                        <input type="checkbox" id="skipCheck">
                        <label for="skipCheck">I already confirmed their webbuilder is compatible with Givebutter widgets.</label>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary"  onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="platformContinue" onclick="checkPlatformPlan()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Step 1.2: Plan Level Check -->
                <div id="step-plan-check" class="step-container">
                    <div class="step-title">📋 Step 1.2: Plan Level Check</div>
                    <div class="step-description" id="planCheckDescription">Let's verify they have the right plan level for widgets.</div>
                    
                    <div class="question" id="planQuestion">What plan do they have?</div>
                    
                    <div id="planOptions">
                        <!-- Options will be populated based on platform -->
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="planContinue" onclick="checkPlanCompatibility()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Step 2: Widget Type -->
                <div id="step-widget-type" class="step-container">
                    <div class="step-title">🎯 Step 2: Widget Type Identification</div>
                    <div class="step-description">Different widget types have different requirements - this helps us ask the right questions.</div>
                    
                    <div class="question">What type of widget is your User trying to install?</div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectWidgetType('button')">
                            <img src="https://i.imgur.com/cZB5wbl.png" alt="Button" style="width: 20px; height: 20px; object-fit: contain;"> Button
                        </button>
                        <button class="option-button" onclick="selectWidgetType('form')">
                            <span>📋</span> Form
                        </button>
                        <button class="option-button" onclick="selectWidgetType('goalbar')">
                            <span>📊</span> Goal Bar
                        </button>
                        <button class="option-button" onclick="selectWidgetType('signup')">
                            <span>📧</span> Signup Form
                        </button>
                    </div>

                    <div class="educational-tip-structured">
                    <strong>Important:</strong> Form widgets only embed the donation section - not campaign images, story, or supporter activity. If Users want the full campaign to be embedded, <a href="https://givebutter.canny.io/raise/p/embed-full-campaigns" target="_blank">upvote this feature request</a>.
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="widgetTypeContinue" onclick="handleWidgetTypeSelection()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Step 3: Payout Setup Check -->
                <div id="step-payout-check" class="step-container">
                    <div class="step-title">💰 Step 3: Payout Setup Check</div>
                    <div class="step-description">Great! <span id="platformName"></span> can definitely support widgets.</div>
                    
                    <div class="question">Have they connected their payout method?</div>
                    <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Without payout info, widgets appear as blank boxes or load forever.
                    </div>
                    
                    <div class="educational-tip-structured">
                        <strong>🔍 How to check:</strong> Click on the <strong>Payouts</strong> tab in the User's dashboard. Accounts that haven't set up their payout method yet will look like this:

                        <div style="margin-top: 15px;">
                            <img src="https://i.imgur.com/8UWth0V.png" alt="Payout tab location" style="width: 100%; max-width: 400px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <img src="https://i.imgur.com/Zk0gt6s.png" alt="Payout error message" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            </div>
                    </div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectPayoutStatus('connected')">
                            <span>✅</span> Payouts are setup
                        </button>
                        <button class="option-button" onclick="selectPayoutStatus('not-connected')">
                            <span>❌</span> No payout info
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="payoutStatusContinue" onclick="handlePayoutStatus()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Step 3.2: Campaign Published Check -->
                <div id="step-campaign-published" class="step-container">
                    <div class="step-title">🟢 Step 3.2: Campaign Published Check</div>
                    
                    <div class="question">Is their campaign active?</div>
                    <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Widgets connected to unpublished campaigns will appear broken. They have nothing to point to.
                    </div>
                    
                    <div class="educational-tip-structured">
        <strong>🔍 How to check:</strong> Click on <strong>Campaigns</strong> in the left-hand menu bar. Check the <strong>Status</strong> of the campaign.
        <div style="margin-top: 15px;">
            <img src="https://i.imgur.com/r8QEjaY.png" alt="Campaigns menu location" style="width: 100%; max-width: 196px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <img src="https://i.imgur.com/XqqDn4K.png" alt="Campaign status display" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        </div>
    </div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectCampaignStatus('published')">
                            <span>🟢</span> Active
                        </button>
                        <button class="option-button" onclick="selectCampaignStatus('unpublished')">
                            <span>🔘</span> Unpublished
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="campaignStatusContinue" onclick="handleCampaignStatus()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Incompatible Plan/Platform -->
                <div id="step-incompatible" class="step-container">
                    <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
                        <strong> 😞 Darn, widgets won't work with their current setup</strong>
                    </div>
                    
                    <div class="solution-title">💬 What to tell your User:</div>
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                         <span id="incompatibleMessage" style="color: #333;"></span>
                        
                        <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                            <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                            <div style="margin-bottom: 8px;">
                                <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                            </div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                                https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                            </div>
                            <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                                Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-secondary" onclick="restartWizard()">← Start Over</button>
                    </div>
                </div>

                <!-- Google Incompatible -->
                <div id="step-google-incompatible" class="step-container">
                    <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                        <strong> 😞 Darn, widgets won't work with their current setup</strong>
                    </div>
                    
                    <div class="solution-title">💬 What to tell your User:</div>
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                        <span style="color: #333;">After checking, I confirmed that Google doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. 😊 Would you like directions on how to do that?</span>
                        
                        <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                            <div style="margin-bottom: 8px;">
                                <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                            </div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                                https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                            </div>
                            <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                                Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                    </div>
                </div>

                <!-- Shopify Incompatible -->
                <div id="step-shopify-incompatible" class="step-container">
                    <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                        <strong> 😞 Darn, widgets won't work with their current setup</strong>
                    </div>
                    
                    <div class="solution-title">💬 What to tell your User:</div>
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                       <span style="color: #333;">After checking, I confirmed that Shopify doesn't currently support Givebutter widgets. I'll upvote you on our feature request to integrate Shopify with Givebutter. In the meantime - you can still share your campaign link directly on your website and on social media. 😊 Would you like directions on how to do that?</span> 
                        
                       <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                    <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal; font-size: 1.1em;">Additional Resources</div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="margin-bottom: 8px;">
                            <a href="https://givebutter.canny.io/integration-requests/p/shopify-integration" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">Shopify Canny Request</a>
                        </div>
                        <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                            https://givebutter.canny.io/integration-requests/p/shopify-integration
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 8px;">
                        <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">Help Article: How to share a campaign</a>
                    </div>
                    <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                        https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                    </div>
                    <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                        Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                    </div>
                </div>
                </div>

                <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                    </div>
                </div> 

                <!-- Other Platform Research -->
                <div id="step-other-research" class="step-container">
                    <div style="color: #333; font-size: 1.0em; margin-bottom: 25px;">
                        <strong>Looks like we don't have any documentation about widgets and <span id="otherPlatformNameDisplay">[PLATFORM NAME]</span></strong>
                    </div>
                    
                    <div class="educational-tip-structured">
                    <div class="step-header">Don't panic, we can still help!</div>
                    
                    <div class="step-item">
                        <strong>🔍 Research Step:</strong> Ask ChatGPT: "Does <span id="otherPlatformNameChatGPT">[PLATFORM NAME]</span> support code injection?"
                    </div>
                    
                    <div class="step-item">
                        <strong>📋 What you'll get:</strong> A summary of whether Givebutter Widgets work with <span class="otherPlatformName">[PLATFORM NAME]</span> and any plan requirements
                    </div>
                    
                    <div class="step-item">
                        <strong>🤔 Your decision:</strong> Is their <span class="otherPlatformName">[PLATFORM NAME]</span> plan compatible with Givebutter widgets?
                    </div>
                </div>

                <div class="options-container">
                    <button class="option-button" onclick="selectCompatibility('not-compatible')">
                        ❌ Not Compatible
                    </button>
                    <button class="option-button" onclick="selectCompatibility('compatible')">
                        ✅ Compatible
                    </button>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                    <button class="btn btn-primary" id="compatibilityContinue" onclick="handleCompatibilitySelection()" disabled>Continue →</button>
                </div>
                </div>

<!-- Other Platform Research Instructions -->
<div id="step-other-platform-research" class="step-container">
    <div class="step-title">Let's find instructions for installing their library code on <span id="otherPlatformNameResearch">[PLATFORM NAME]</span>.</div>
    
    <div class="educational-tip-structured">
        <div class="step-header">No worries, we can figure this out!</div>
        
        <div class="step-item">
            <strong>🔍 Research Step:</strong> Ask Google: "how to install custom code in <span id="otherPlatformNameGoogle">[PLATFORM NAME]</span> website"
        </div>
        
        <div class="step-item">
            <strong>🤖 Skip the AI summary.</strong> These can be inaccurate. We want instructions written specifically by <span id="otherPlatformNameInstructions">[PLATFORM NAME]</span>.
        </div>
        
        <div class="step-item">
            <strong>👀 Look for pages that reference:</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
                <li>Custom HTML</li>
                <li>Embed custom code</li>
                <li>Embed elements</li>
                <li>Code injection</li>
                <li>Insert/install custom code</li>
            </ul>
        </div>
    </div>
    
    <div style="margin-bottom: 15px; font-weight: 600; color: #333;">
        Once you find the best resource for your user, paste the web address here:
    </div>
    
    <textarea id="otherPlatformUrl" class="large-textarea" placeholder="Paste the web address here..." rows="3" oninput="checkOtherPlatformUrl()"></textarea>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="otherPlatformUrlContinue" onclick="proceedToOtherPlatformInstructions()" disabled style="opacity: 0.5;">Continue →</button>
    </div>
</div>

<!-- Other Platform Library Installation Instructions -->
<div id="step-other-platform-instructions" class="step-container">
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="otherPlatformUserInstructions">
        I double-checked your website, and I see the library code isn't installed yet. I found this resource from <span id="otherPlatformNameInstructionsFinal">[PLATFORM NAME]</span> that explains how to add the library code to your website.<br>
        
        <div style="margin-top: 20px;">
            <a href="#" target="_blank" style="color: #333; font-weight: 600; text-decoration: underline;" id="otherPlatformResourceLink">https://example.com/instructions</a><br><br>
            
            Here is your exact library code to use:<br>
            
            <div class="code-block" id="otherPlatformLibraryCodeDisplay">
&lt;script
    async
    src="https://widgets.givebutter.com/latest.umd.cjs?acct=XE8NSeupPNYijQZ9&p=squarespace"
&gt;&lt;/script&gt;
            </div>
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('otherPlatformUserInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectOtherPlatformResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectOtherPlatformResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="otherPlatformResultContinue" onclick="handleOtherPlatformResult()" disabled>Continue →</button>
    </div>
</div>

                <!-- Generic Platform Incompatible -->
                <div id="step-generic-incompatible" class="step-container">
                    <div style="color: #333; font-size: 1.0em; margin-bottom: 15px;">
                        <strong> 😞 Darn, widgets won't work with their current setup</strong>
                    </div>
                    
                    <div class="solution-title">💬 What to tell your User:</div>
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
                        <span style="color: #333;" id="genericIncompatibleMessage">After checking, I confirmed that [PLATFORM NAME] doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. 😊 Would you like directions on how to do that?</span>
                        
                        <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                            <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                            <div style="margin-bottom: 8px;">
                                <a href="https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to share a campaign</a>
                            </div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                                https://help.givebutter.com/en/articles/3471486-how-to-share-a-campaign
                            </div>
                            <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                                Directions on text-to-donate, QR codes, and the <strong>Share this fundraiser</strong> feature built right into their campaign.
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary"  onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-secondary" onclick="restartWizard()">Start Over</button>
                    </div>
                </div>

                <!-- No Payout Solution -->
               <div id="step-payout-solution" class="step-container">
        <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
            <strong>🎉 Another common culprit! This could be the cause.</strong>
        </div>
        
        <div class="solution-title">💬 What to tell your User:</div>
        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
            <span style="color: #333;">Ah, it looks like you still need to connect your payout information. That has to be completed before widgets can work. Here are instructions on how to do that.</span>
            
            <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">Relevant Help Article</div>
                <div style="margin-bottom: 8px;">
                    <a href="https://help.givebutter.com/en/articles/10401823-how-to-add-and-edit-your-payout-information-with-stripe-connect" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">How to add and edit your payout information with Stripe Connect</a>
                </div>
                <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
                    https://help.givebutter.com/en/articles/10401823-how-to-add-and-edit-your-payout-information-with-stripe-connect
                </div>
                <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                    🕵️ Most agents miss this step - you caught it!
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="btn btn-secondary"  onclick="goToPreviousStep()">← Back</button>
            <button class="btn btn-primary" onclick="nextStep('step-campaign-published')">Continue →</button>
        </div>
    </div>

                <!-- Campaign Not Published Solution -->
                <div id="step-unpublished-solution" class="step-container">
        <div style="color: #333; font-size: 1.2em; margin-bottom: 15px;">
            <strong>This is probably why the widget isn't working.</strong>
        </div>
        
        <div class="solution-title">💬 What to tell your User:</div>
        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #2e7d32; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
            <span style="color: #333;">I found the issue! Your campaign needs to be published before the widget can work. Let's get that published and see if your widget starts working properly. 😊</span>
            
            <div style="margin-top: 25px; padding-top: 10px; border-top: 1px solid #c8e6c9;">
                <div style="font-weight: 600; color: #2e7d32; margin-bottom: 15px; font-style: normal;">📝 Steps to share:</div>
                <div style="color: #333; line-height: 1.5;">
                    <strong>1.</strong> Go to your campaign in your dashboard. On the top right corner, click the blue button that says <strong>Publish.</strong><br>
                    <strong>2.</strong> The <strong>Unpublished</strong> label should disappear<br>
                    <strong>3.</strong> Try your widget again!
                </div>
                <img src="https://i.imgur.com/9zoPDFp.png" alt="Widget working example" style="width: 100%; max-width: 400px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em; margin-top: 15px;">
                    🎯 You're doing great! This is exactly the right approach!
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
            <button class="btn btn-primary" onclick="handleCampaignPublished()">Continue →</button>
        </div>
    </div>

                <!-- Code Collection -->
                <div id="step-code-collection" class="step-container">
                    <div class="step-title">📝 Code Collection</div>
                    
                    <div class="educational-tip-structured">
                        <strong>🕵️ Time for some detective work!</strong> There are two pieces of code for each widget: the <strong>library code</strong> and the <strong>widget code</strong>. We need to confirm that both pieces of code are installed on the user's website.
                            <br><br>
                        <strong>🚗</strong> Think of widgets like a car - you need both the ENGINE (library code) and the STEERING WHEEL (widget code) to get anywhere. Lots of people install one but forget the other!
            </div>   
                    
                    <div style="color: #666; margin-bottom: 20px;">
                        🚨 Sometimes, the Givebutter dashboard says the library is installed when it's actually not. Only check the button below if you have manually confirmed the library code is present on the user's website.
                    </div>
                    
                   <div class="checkbox-container" id="librarySkipCheck" onclick="toggleLibraryConfirmed()" style="cursor: pointer;">
                    <input type="checkbox" id="libraryConfirmed">
                    <label for="libraryConfirmed">I already confirmed they have the library code installed</label>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="libraryCheckButton" onclick="nextStep('step-library-check')">Check Library Code →</button>
                    </div>
                </div>

                <!-- Library Code Check -->
                <div id="step-library-check" class="step-container">
                    <div class="step-title">📚 Step 4: Library Code Detection</div>
                    <div class="step-description">First, let's check if they installed their library code.</div>
                    
                    <div class="question">What's the website URL where the widget should appear?</div>
                    <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Make sure this is the exact page URL they want the widget on, not just their home page.
                    </div>
                    
                    <input type="text" class="text-input" id="websiteUrl" placeholder="https://example.com/donate" onkeyup="checkUrlInput()">

                    <div class="action-buttons">
                        <button class="btn btn-secondary"  onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="urlContinue" onclick="startLibraryInspection()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Library Inspection Steps -->
                <div id="step-library-inspection" class="step-container">
                    <div class="step-title">🕵🏽‍♂️ Library Code Inspection</div>
                    <div class="step-description">Time to check if the library code is actually installed on their website.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header"> 🔍 How to check:</div>
                        
                        <div class="step-item">
                            <strong>1.</strong> Go to <strong id="inspectionUrl"></strong>
                        </div>
                        
                        <div class="step-item">
                            <strong>2.</strong> Right-click anywhere on the page and select "Inspect" or "Inspect Element" (or press F12)
                        </div>
                        
                        <div class="step-item">
                            <strong>3.</strong> Select the <strong>Elements</strong> tab.
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <img src="https://i.imgur.com/wWGoMNl.png" alt="Elements tab location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        </div>
                        
                        <div class="step-item">
                            <strong>4.</strong> Press Ctrl+F (or Cmd+F on Mac) to open the search box
                        </div>
                        
                        <div class="step-item">
                            <strong>5.</strong> Search for: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px;">latest.umd.cjs</code>
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #c8e6c9; color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            ❗️ Remember - even if the Givebutter dashboard says the library is installed, that might not be true! This manual check is the only way to be sure.
                        </div>
                    </div>
                    
                    <div class="question">Does anything highlight in yellow or show up in the search results?</div>
                    <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Leave their webpage and that search box open; we might need it again in a minute.
                    </div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectLibraryFound('found')">
                            <span>✅</span> Found it! 
                        </button>
                        <button class="option-button" onclick="selectLibraryFound('not-found')">
                            <span>❌</span> Nothing found 
                        </button>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="libraryFoundContinue" onclick="handleLibraryResult()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Library Not Found - Install Instructions -->
                <div id="step-library-install" class="step-container">
                    <div class="step-title">📝 Library Code Installation</div>
                    <div class="step-description">Aha! The library code is missing. Let's get that fixed!</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">💬 What to tell your User:</div>
                        
                        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 15px 0; font-size: 1.0em;">
                            I double-checked your website, and I see the library code isn't installed yet. Let's get that taken care of. I'd be happy to walk you through step-by-step right now, or I can send you the instructions for that part. What would you like to do?
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #c8e6c9; color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            💛 Installing code can feel overwhelming, so it's helpful to check in before sending a help article. When someone reaches out, they're often looking for emotional support—not just instructions. Offering them a choice shows we're here to help in whatever way feels best for them.
                        </div>
                    </div>

                    <div class="options-container">
                        <button class="option-button" onclick="selectInstallOption('step-by-step')">
                            <span>📋</span> Step-by-step help
                        </button>
                        <button class="option-button" onclick="selectInstallOption('send-article')">
                            <span>➡️</span> Check widget code
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="installOptionContinue" onclick="handleInstallOption()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Get Library Code -->
    <div id="step-get-library-code" class="step-container">
        <div class="step-title">Great, we'll walk them through installing the library code together.</div>
        
        <div style="color: #666; margin-bottom: 20px;">
            You'll need to find the user's library code for the next step. Follow these instructions to get their specific code.
        </div>
        
        <div class="educational-tip-structured">
            <div style="font-weight: bold; font-size: 1.1em; margin-bottom: 15px; color: #1a3a0d;">📝 Steps for you:</div>
            
            <div style="margin-bottom: 15px;">
                <strong>1.</strong> Go to their campaign in their Givebutter dashboard
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>2.</strong> Click on the <strong>Sharing</strong> tab
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>3.</strong> Click <strong>Widgets</strong>
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>4.</strong> Click the blue text that says <strong>Installation</strong>
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/T8HEVex.png" alt="Installation button location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>5.</strong> Choose <strong><span id="selectedPlatformName">[Platform Name]</span></strong>
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>6.</strong> Copy the library code
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/hxx9XQQ.png" alt="Library code location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <label for="libraryCode" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their library code here:</label>
            <textarea id="libraryCode" placeholder="Paste the library code here..." style="width: 100%; min-height: 80px; padding: 15px; border: 2px solid #ddd; border-radius: 12px; font-size: 1em; outline: none; resize: vertical;" rows="3" onkeyup="checkLibraryCode()"></textarea>
        </div>

        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
            <button class="btn btn-primary" id="libraryCodeContinue" onclick="showPlatformInstructions()" disabled style="opacity: 0.5;">Got the Library Code →</button>
        </div>
    </div>

    <!-- Get Library Code - WordPress -->
    <div id="step-get-library-code-wordpress" class="step-container">
        <!-- Page 1: Get Account ID -->
        <div id="wordpress-page1">
            <div class="step-title">Great, we'll walk them through installing the library code together.</div>
            
            <div style="color: #666; margin-bottom: 20px;">
                You'll need to find the user's Givebutter Account ID for the next step. This is not the same account ID found in their URL or in Forest. The only place to find it is by following these instructions.
            </div>
            
            <div class="educational-tip-structured">
                <div style="font-weight: bold; font-size: 1.1em; margin-bottom: 15px; color: #1a3a0d;">📝 Steps for you:</div>
                
                <div style="margin-bottom: 15px;">
                    <strong>1.</strong> Go to their campaign in their Givebutter dashboard
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong>2.</strong> Click on the <strong>Sharing</strong> tab
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong>3.</strong> Click <strong>Widgets</strong>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong>4.</strong> Click the blue text that says <strong>Installation</strong>
                    <div style="margin: 15px 0;">
                        <img src="https://i.imgur.com/T8HEVex.png" alt="Installation button location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    </div>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong>5.</strong> Choose <strong>WordPress</strong>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <strong>6.</strong> Copy the long string of letters and numbers in the Account ID box
                    <div style="margin: 15px 0;">
                        <img src="https://i.imgur.com/Aa44RVU.png" alt="Account ID box location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>
            
            <div style="margin: 20px 0;">
                <label for="wordpressAccountId" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their Account ID here:</label>
                <input type="text" id="wordpressAccountId" placeholder="Paste the Account ID here..." style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 12px; font-size: 1em; outline: none;" onkeyup="checkWordPressAccountId()">
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                <button class="btn btn-primary" id="wordpressContinueBtn" onclick="showWordPressPage2()" disabled style="opacity: 0.5;">Got the Account ID →</button>
            </div>
        </div>

        <!-- Page 2: User Instructions -->
    <div id="wordpress-page2" style="display: none;">
        <div class="step-title">WordPress uses the Givebutter plugin for easier setup!</div>
        
        <div class="solution-title">💬 What to tell your User:</div>
        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="wordpressCustomerInstructions">
        Great news! WordPress has an official Givebutter plugin that makes installing widgets super easy. 🎉 Here's how to get started.<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Log in to your WordPress dashboard<br>
            <strong>2.</strong> Go to <strong>Plugins → Add New</strong> in the left menu<br>
            <strong>3.</strong> Search for "Givebutter" in the search box<br>
            <strong>4.</strong> Click <strong>Install Now</strong> on the official Givebutter plugin<br>
            <strong>5.</strong> After installation, click <strong>Activate Plugin</strong><br>
            <strong>6.</strong> Go to <strong>Settings → Givebutter</strong> and enter this Account ID: <span id="wordpressDisplayAccountId" style="background: #2d3748; color: #e2e8f0; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-weight: bold;">[Account ID will appear here]</span><br>
            <strong>7.</strong> Save settings - your library code is now automatically installed!
        </div>
    </div>

    <div style="margin-top: 20px; text-align: center;">
        <button onclick="copyInstructionBox('wordpressCustomerInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em; margin: 20px 0;">
        🎯 Much easier than manual code installation! WordPress plugins handle all the technical stuff automatically.
    </div>

    <div style="margin-top: 25px;">
        <div style="margin-bottom: 8px;">
            <a href="https://wordpress.org/plugins/givebutter/" target="_blank" style="color: #333; font-weight: 600; text-decoration: none;">Official Givebutter WordPress Plugin</a>
        </div>
        <div style="color: #666; font-size: 0.9em; margin-bottom: 8px; word-break: break-all;">
            https://wordpress.org/plugins/givebutter/
        </div>
    </div>
        

        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="showWordPressPage1()">← Back to Account ID</button>
            <button class="btn btn-primary" onclick="handleLibraryInstallContinue('step-widget-code-detection-wordpress')">Continue →</button>
        </div>
    </div>
    </div>

    <!-- Get Library Code - Squarespace -->
<div id="step-get-library-code-squarespace" class="step-container">
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="squarespaceUserInstructions">
        To install the library on your Squarespace website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Click on the <strong>Website</strong> heading in your Squarespace account.<br>
            <strong>2.</strong> Scroll down, and under the <strong>Utilities</strong> heading, click <strong>Website Tools</strong>.<br>
            <strong>3.</strong> Click <strong>Code Injection</strong>.<br>
            <strong>4.</strong> Under the <strong>Header</strong> section, paste the library code below, and save.<br>
            
            <div class="code-block" id="squarespaceLibraryCodeDisplay">[Library code will appear here]</div>
        </div>
    </div>
        
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('squarespaceUserInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" onclick="handleLibraryInstallContinue('step-widget-code-detection')">Continue →</button>
    </div>
</div>

    <!-- Get Library Code - GoDaddy -->
<div id="step-get-library-code-godaddy" class="step-container">
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="godaddyUserInstructions">
        To install the library on your GoDaddy website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Log in to your GoDaddy account.<br>
            <strong>2.</strong> Scroll to <strong>Websites + Marketing</strong> and select <strong>Manage</strong> next to your website to open your site.<br>
            <strong>3.</strong> Select <strong>Edit Website</strong> or <strong>Edit Site</strong> to open your website builder.<br>
            <strong>4.</strong> Go to the page and location you want to add your custom code, and add a section.<br>
            <strong>5.</strong> Search for <strong>HTML section</strong> and select <strong>Add</strong>. Paste the code below in the <strong>Custom Code</strong> field.<br>
            
            <div class="code-block" id="godaddyLibraryCodeDisplay">[Library code will appear here]</div>
        </div>
    </div>
        
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('godaddyUserInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" onclick="handleLibraryInstallContinue('step-widget-code-detection')">Continue →</button>
    </div>
</div>
                
        <!-- Get Library Code - Weebly -->
<div id="step-get-library-code-weebly" class="step-container">
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="weeblyUserInstructions">
        To install the library on your Weebly website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Log in to your Weebly account.<br>
            <strong>2.</strong> Navigate to <strong>Settings → SEO → Header code</strong>.<br>
            <strong>3.</strong> Copy and paste the code below in the <strong>Header Type</strong> text field.<br>
            
            <div class="code-block" id="weeblyLibraryCodeDisplay">[Library code will appear here]</div>
        </div>
    </div>
        
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('weeblyUserInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" onclick="handleLibraryInstallContinue('step-widget-code-detection')">Continue →</button>
    </div>
</div>

                <!-- Platform Installation Instructions -->
                <div id="step-platform-instructions" class="step-container">
                    <div class="step-title">🔧 Platform Installation Instructions</div>
                    <div class="step-description">Here are the step-by-step instructions for their specific platform.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">💬 What to tell your User:</div>
                        
                        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 15px 0; font-size: 1.0em;" id="platformInstructionsContent">
                            <!-- Content will be populated based on platform -->
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #c8e6c9;">
                            <div style="font-weight: 600; color: #1a3a0d; margin-bottom: 15px;">📝 Library Code to Install:</div>
                            <div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.9em; overflow-x: auto; white-space: pre-wrap;" id="libraryCodeDisplay"></div>
                        </div>
                    </div>

                    <div class="options-container">
                        <button class="option-button" onclick="selectPlatformInstructionChoice('solved')">
                            <span>✅</span> Done, that solved it!
                        </button>
                        <button class="option-button" onclick="selectPlatformInstructionChoice('widget-detection')">
                            <span>➡️</span> Now check widget code
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="platformInstructionsContinue" onclick="handlePlatformInstructions()" disabled>Continue →</button>
                    </div>
                </div>

    <!-- Advanced Troubleshooting -->
                <div id="step-advanced-troubleshooting" class="step-container">
                    <div class="step-title">🤔 Widget still not working</div>
                    <div class="step-description">Here are some rarer situations that you should check before creating a linear ticket.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">🔍 What to check:</div>
                        
                        <div class="step-item">
                            <strong>1. Is their newest version of the website published?</strong><br>
                            Sometimes users make changes but forget to publish/save their updates. Have them republish or save their website to make sure all changes are live.
                        </div>
                        
                        <div class="step-item">
                            <strong>2. Are they looking at their published page or are they still in the web builder?</strong><br>
                            Some web builders don't show a visual of the widget, so it may appear broken. Always check the actual website to confirm.
                        </div>
                        
                        <div class="step-item">
                            <strong>3. If you helped them install the library or widget code, did they actually do it?</strong><br>
                            Double-check their website again manually. People sometimes say "yes, I did it" but haven't actually completed the installation.
                        </div>
                        
                        <div class="step-item">
                            <strong>4. Did they accidentally install multiple instances of their library or widget code?</strong><br>
                            Be careful on this step, because multiple DIFFERENT widget codes are fine - a goal bar and a button, for example. If they have doubles of the SAME code, have them remove the duplicates.
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>After checking these items, did any of them solve the issue?</strong>
                    </div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectAdvancedTroubleshootingResult('solved')">
                            <span>✅</span> Yes, widget is working now!
                        </button>
                        <button class="option-button" onclick="selectAdvancedTroubleshootingResult('create-ticket')">
                            <span>❌</span> Still not working - create ticket
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="advancedTroubleshootingContinue" onclick="handleAdvancedTroubleshootingResult()" disabled>Continue →</button>
                    </div>
                </div>
                
<!-- Linear Ticket Creation -->
<div id="step-create-linear-ticket" class="step-container">
    <div class="step-title">📋 Time to submit a linear ticket</div>
    <div class="step-description">You've completed all the basic troubleshooting steps. Since the widget still isn't working, it's time to <a href="https://www.notion.so/givebutter/Linear-b8b6e269664043c4a17aaa2f9b321063" target="_blank" style="color: #9c27b0; font-weight: 600; text-decoration: underline;">submit a linear ticket</a>.</div>
    
    <div class="educational-tip-structured">
        <div class="step-header">📝 Steps for you:</div>
        
        <div class="step-item">
            <strong>1.</strong> Create a linear ticket.
        </div>
        
        <div class="step-item">
            <strong>2.</strong> Copy your progress tracker notes using the copy button below.
        </div>
        
        <div class="step-item">
            <strong>3.</strong> Paste the progress tracker notes into your linear.
        </div>
    </div>

    <div style="margin: 20px 0; text-align: center;">
        <button onclick="copyProgressTracker(this)" style="background: #9c27b0; color: white; border: none; padding: 15px 25px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; font-size: 1em;">
            📋 Copy Progress Tracker Notes
        </button>
    </div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;">
        I need to escalate this to our advanced team for further investigation. This may take some time, so I'll keep you updated via email. Is there anything else I can help with for now?
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" onclick="restartWizard()">Start Over</button>
    </div>
</div>
                
                <!-- Problem Solved -->
                <div id="step-problem-solved" class="step-container">
                    <div class="step-title">🎉 Fantastic! Widget Issue Resolved!</div>
                    <div class="step-description">You successfully diagnosed and solved the widget issue!<br>You're officially a Widget Wizard!</div>
                    
                    <div style="text-align: center; margin: 30px 0;">
                        <img src="https://i.imgur.com/C63gJlP.png" alt="Widget Wizard Achievement" style="max-width: 100%; height: auto; border: 3px solid #000; border-radius: 12px;">
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" onclick="restartWizard()">Start over</button>
                    </div>
                </div>

                <!-- Step 5: Widget Code Detection -->
    <div id="step-widget-code-detection" class="step-container">
        <div class="step-title">📝 Step 5: Widget Code Detection</div>
        <div class="step-description">Time to find their specific <strong id="widgetTypeDisplay">Button Widget</strong> code and check if it's installed correctly. More than one widget can be installed on a website. For now, we'll troubleshoot the specific widget they asked about. You can follow these instructions for any additional widgets that might be causing them trouble.</div>
        
        <div class="educational-tip-structured">
            <div class="step-header">📝 Steps for you:</div>
            
            <div class="step-item">
                <strong>1.</strong> Go to their campaign in their Givebutter dashboard
            </div>
            
            <div class="step-item">
                <strong>2.</strong> Click on the <strong>Sharing</strong> tab
            </div>
            
            <div class="step-item">
                <strong>3.</strong> Click <strong>Widgets</strong>
            </div>
            
            <div class="step-item">
                <strong>4.</strong> Find their <strong id="widgetTypeDisplay2">Button Widget</strong> and click the <strong>Embed</strong> button.
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/B7FJqig.png" alt="Embed button" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
            </div>
            
            <div class="step-item">
                <strong>5.</strong> Copy the entire widget code block
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/vhpSzj8.png" alt="Widget code example" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <label for="userWidgetCode" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their <span id="widgetTypeDisplay3">Button Widget</span> code here:</label>
            <textarea id="userWidgetCode" placeholder='Paste the complete widget code here (should start with &lt;givebutter-widget id...)' class="large-textarea" rows="2" style="min-height: 60px; margin-bottom: 0;" oninput="checkWidgetCode()"></textarea>
    <div id="regularWidgetCodeError" style="color: #c62828; font-size: 0.9em; margin-top: 5px; display: none;">
        ⚠️ Widget code should start with &lt;givebutter-widget id=
    </div>
        </div>

        <div class="checkbox-container" onclick="toggleWidgetConfirmed()" style="cursor: pointer;">
             <input type="checkbox" id="widgetConfirmed">
             <label for="widgetConfirmed">I already confirmed they have the widget code installed</label>
            </div>

        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
            <button class="btn btn-primary" id="widgetCodeContinue" onclick="proceedToWidgetSearch()" disabled style="opacity: 0.5;">Got the widget code →</button>
        </div>
    </div>

                <!-- Step 5: Widget Code Detection - WordPress -->
    <div id="step-widget-code-detection-wordpress" class="step-container">
        <div class="step-title">📝 Step 5: Widget Code Detection</div>
        <div class="step-description">Time to find their specific <strong id="widgetTypeDisplayWP">Button Widget</strong> code and check if it's installed correctly. More than one widget can be installed on a website. For now, we'll troubleshoot the specific widget they asked about. You can follow these instructions for any additional widgets that might be causing them trouble.</div>
        
        <div class="educational-tip-structured">
            <div class="step-header">📝 Steps for you:</div>
            
            <div class="step-item">
                <strong>1.</strong> Go to their campaign in their Givebutter dashboard
            </div>
            
            <div class="step-item">
                <strong>2.</strong> Click on the <strong>Sharing</strong> tab
            </div>
            
            <div class="step-item">
                <strong>3.</strong> Click <strong>Widgets</strong>
            </div>
            
            <div class="step-item">
                <strong>4.</strong> Find their <strong id="widgetTypeDisplayWP2">Button Widget</strong> and click the <strong>Embed</strong> button.
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/B7FJqig.png" alt="Embed button" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>
            
            <div class="step-item">
                <strong>5.</strong> Copy the entire widget code block and paste in the first box below.
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/vhpSzj8.png" alt="Widget code example" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>
            
            <div class="step-item">
                <strong>6.</strong> Also copy the shortcode. Paste that in the second box below.
                <div style="margin: 15px 0;">
                    <img src="https://i.imgur.com/oHKF69U.png" alt="Shortcode example" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
            </div>
        </div>
        
        <div style="margin: 20px 0 0 0;">
            <label for="userWidgetCodeWordpress" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their <strong id="widgetTypeDisplayWP3">Button Widget</strong> code here:</label>
            <textarea id="userWidgetCodeWordpress" placeholder='Paste the complete widget code here (should start with &lt;givebutter-widget id...)' class="large-textarea" rows="2" style="min-height: 60px; margin-bottom: 0;" oninput="checkWordpressWidgetCode()"></textarea>
    <div id="widgetCodeError" style="color: #c62828; font-size: 0.9em; margin-top: 5px; display: none;">
        ⚠️ Widget code should start with &lt;givebutter-widget id=
    </div>
        </div>

        <div style="margin: 0 0 20px 0;">
            <label for="userShortcode" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their <strong>shortcode</strong> here:</label>
            <textarea id="userShortcode" placeholder='Paste the shortcode here (should look like [givebutter id="..."])' class="large-textarea" rows="1" style="min-height: 50px; resize: none; margin-bottom: 0;" onkeyup="checkWordpressShortcode()"></textarea>
    <div id="shortcodeError" style="color: #c62828; font-size: 0.9em; margin-top: 5px; display: none;">
        ⚠️ Shortcode should start with [givebutter id=
    </div>
        </div>

    <div class="checkbox-container" onclick="toggleWordpressWidgetConfirmed()" style="cursor: pointer;">
                        <input type="checkbox" id="wordpressWidgetConfirmed">
                        <label for="wordpressWidgetConfirmed">I already confirmed they have the widget code installed</label>
                    </div>

        <div class="action-buttons">
            <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
            <button class="btn btn-primary" id="wordpressWidgetCodeContinue" onclick="proceedToWordpressWidgetSearch()" disabled style="opacity: 0.5;">Got the widget code →</button>
        </div>
    </div>

    <!-- Website URL Collection (when skipped from library check) -->
                <div id="step-website-url" class="step-container">
                    <div class="step-title">🌐 Website address</div>
                    
                    <div class="question">What's the website URL where their <strong id="widgetTypeDisplayURL">Button Widget</strong> should appear?</div>
                    <div style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Make sure this is the exact page URL they want the widget on, not just their home page.
                    </div>
                    
                    <input type="text" class="text-input" id="widgetWebsiteUrl" placeholder="https://example.com/donate" onkeyup="checkWidgetUrlInput()">

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="widgetUrlContinue" onclick="proceedToWidgetInspection()" disabled>Continue →</button>
                    </div>
                </div>

    <!-- Widget Code Inspection -->
                <div id="step-widget-inspection" class="step-container">
                    <div class="step-title">🕵🏽‍♂️ Widget Code Inspection</div>
                    <div class="step-description">Let's check if their <strong id="widgetTypeDisplayInspection">Button Widget</strong> code is correctly installed on their website.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">🔍 How to check:</div>
                        
                        <div class="step-item">
                            <strong>1.</strong> Go to <strong id="widgetInspectionUrl"></strong>
                        </div>
                        
                        <div class="step-item">
                            <strong>2.</strong> Right-click anywhere on the page and select "Inspect" or "Inspect Element" (or press F12)
                        </div>
                        
                        <div class="step-item">
                            <strong>3.</strong> Select the <strong>Elements</strong> tab.
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <img src="https://i.imgur.com/wWGoMNl.png" alt="Elements tab location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        </div>
                        
                        <div class="step-item">
                            <strong>4.</strong> Press Ctrl+F (or Cmd+F on Mac) to open the search box
                        </div>
                        
                        <div class="step-item">
                            <strong>5.</strong> Search for: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px; font-family: monospace;" id="widgetSearchTerm">givebutter-widget id="abc123"</code>
                        </div>

                        <div class="step-item" id="shortcodeSearchStep" style="display: none;">
                            <strong>6.</strong> If you don't find anything with their full widget code, search for their shortcode instead: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px; font-family: monospace;" id="shortcodeSearchTerm">[givebutter id="abc123"]</code>
                        </div>
                    </div>
                    
                    <div class="question">Does anything highlight in yellow or show up in the search results?</div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectWidgetFound('found')">
                            <span>✅</span> Found it! 
                        </button>
                        <button class="option-button" onclick="selectWidgetFound('not-found')">
                            <span>❌</span> Nothing found 
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" id="widgetInspectionBackBtn" onclick="goBackFromWidgetInspection()">← Back</button>
                        <button class="btn btn-primary" id="widgetFoundContinue" onclick="handleWidgetResult()" disabled>Continue →</button>
                    </div>
                </div>

    <!-- Widget Installation Choice -->
                <div id="step-widget-install-choice" class="step-container">
                    <div class="step-title">📝 <span id="widgetTypeDisplayInstallChoice">Button Widget</span> Installation</div>
                    <div class="step-description">Aha! The <span id="widgetTypeDisplayInstallChoice2">Button Widget</span> code is missing. Let's get that fixed!</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">💬 What to tell your User:</div>
                        
                        <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 15px 0; font-size: 1.0em;">
                            I took a look at your site and noticed the widget code still needs to be added. We can take care of that now—I'm happy to guide you through it step-by-step, or I can share the setup instructions for you to follow on your own. What works best for you?
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #c8e6c9; color: #2e7d32; font-style: italic; line-height: 1.4; font-size: 0.9em;">
                            😊 Installing code can be intimidating, so check in first. People often need reassurance as much as instructions. Offering options shows we're here for them either way.
                        </div>
                    </div>

                    <div class="options-container">
                        <button class="option-button" onclick="selectWidgetInstallOption('step-by-step')">
                            <span>📋</span> Step-by-step help
                        </button>
                        <button class="option-button" onclick="selectWidgetInstallOption('send-instructions')">
                            <span>➡️</span> Send instructions
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="widgetInstallChoiceContinue" onclick="handleWidgetInstallChoice()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- WordPress Widget Installation -->
<div id="step-widget-install-wordpress" class="step-container">
    <div class="step-title">🔧 WordPress - <span id="widgetTypeDisplayWPInstall">Button Widget</span> Installation</div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="wordpressWidgetInstructions">
        To install your <span id="widgetTypeDisplayWPInstall2">Button Widget</span> on your WordPress website, please follow these steps:<br>

        <div style="margin-top: 20px;">
            <strong>1.</strong> In the WordPress dashboard, select <strong>Pages</strong> from the left-hand navigation menu.<br>
            <strong>2.</strong> Select the page you'd like to embed the widget on.<br>
            <strong>3.</strong> Once in the editor, click the <strong>+ button</strong> to add a new block. Select <strong>Custom HTML</strong>. You may need to search for this block.<br>
            <strong>4.</strong> Copy and paste the below code into the HTML block and click <strong>Update</strong>.<br>
            
            <div class="code-block" id="wordpressWidgetCodeDisplay">&lt;givebutter-widget id="abc123"&gt;&lt;/givebutter-widget&gt;</div><br>
            
            <strong>5.</strong> Alternatively, you can utilize the shortcode below to embed the widget.<br>
            
            <div class="code-block" id="wordpressShortcodeDisplay">[givebutter id="abc123"]</div>
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('wordpressWidgetInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="wordpressInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
    </div>
</div>

                <!-- Squarespace Widget Installation -->
<div id="step-widget-install-squarespace" class="step-container">
    <div class="step-title">🎨 Squarespace - <span id="widgetTypeDisplaySSInstall">Button Widget</span> Installation</div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="squarespaceWidgetInstructions">
        To install your <span id="widgetTypeDisplaySSInstall2">Button Widget</span> on your Squarespace website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Select <strong>Pages</strong> from the main dashboard and navigate to the specific page where you want to add the widget.<br>
            <strong>2.</strong> Click the <strong>+ Add</strong> icon to add a new block and select <strong>Code</strong> from the menu. Copy the code below for your created widget and paste it into the code block and <strong>save</strong>.<br>
            
            <div class="code-block" id="squarespaceWidgetCodeDisplay">&lt;givebutter-widget id="abc123"&gt;&lt;/givebutter-widget&gt;</div>
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('squarespaceWidgetInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="squarespaceInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
    </div>
</div>

                <!-- GoDaddy Widget Installation -->
<div id="step-widget-install-godaddy" class="step-container">
    <div class="step-title">🌐 GoDaddy - <span id="widgetTypeDisplayGDInstall">Button Widget</span> Installation</div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="godaddyWidgetInstructions">
        To install your <span id="widgetTypeDisplayGDInstall2">Button Widget</span> on your GoDaddy website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Click on the HTML section where you've inserted the library code, and paste your widget's code immediately below it.<br>
            
            <div class="code-block" id="godaddyWidgetCodeDisplay">&lt;givebutter-widget id="abc123"&gt;&lt;/givebutter-widget&gt;</div>
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('godaddyWidgetInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="godaddyInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
    </div>
</div>

                <!-- Weebly Widget Installation -->
<div id="step-widget-install-weebly" class="step-container">
    <div class="step-title">🏗️ Weebly - <span id="widgetTypeDisplayWeeblyInstall">Button Widget</span> Installation</div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="weeblyWidgetInstructions">
        To install your <span id="widgetTypeDisplayWeeblyInstall2">Button Widget</span> on your Weebly website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> On the left sidebar, find the <strong>Embed Code</strong> element under the <strong>Basic</strong> section. Click on it, drag it to where you want your widget to appear.<br>
            <strong>2.</strong> Click on <strong>Click to set custom HTML</strong>, paste your widget's HTML code into the provided space and <strong>save</strong>.<br>
            
            <div class="code-block" id="weeblyWidgetCodeDisplay">&lt;givebutter-widget id="abc123"&gt;&lt;/givebutter-widget&gt;</div>
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('weeblyWidgetInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="weeblyInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
    </div>
</div>

    <!-- Wix Widget Installation -->
<div id="step-widget-install-wix" class="step-container">
    <div class="step-title"><img src="https://i.imgur.com/yp0GcQp.png" alt="Wix" style="width: 20px; height: 20px; object-fit: contain; margin-right: 8px;"> <span id="widgetTypeDisplayWixInstall">Button Widget</span> Installation</div>
    
    <div class="solution-title">💬 What to tell your User:</div>
    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%); border: 2px solid #4CAF50; color: #333; padding: 20px; border-radius: 12px; margin: 5px 0 20px 0; font-size: 1.0em;" id="wixWidgetInstructions">
        To install your <span id="widgetTypeDisplayWixInstall2">Button Widget</span> on your Wix website, please follow these steps:<br>
        
        <div style="margin-top: 20px;">
            <strong>1.</strong> Log into your Wix account, and click on the site you'd like to edit in your Wix dashboard. Click <strong>Edit Site</strong> to open your site editor.<br>
            <strong>2.</strong> Click the large blue plus sign located in the site editor.<br>
            <strong>3.</strong> Under the <strong>Add to site</strong> menu, click <strong>Embed Code</strong>, and then select <strong>Custom element</strong>.<br>
            <strong>4.</strong> After you click <strong>Custom element</strong>, a placeholder object will be added to your site preview. If applicable, move the placeholder to the desired location of your Widget.<br>
            <strong>5.</strong> Click <strong>Choose Source</strong>.<br>
            <strong>6.</strong> Under <strong>Server URL</strong>, add your library code:<br>
            
            <div class="code-block" id="wixLibraryCodeDisplay">https://widgets.givebutter.com/latest.umd.cjs</div><br>
            
            <strong>7.</strong> Under <strong>Tag name</strong>, add <strong>givebutter-widget</strong>.<br>
            <strong>8.</strong> Next, click <strong>Set Attributes</strong> to complete the embed. Under <strong>Attribute name</strong>, add <strong>id</strong>. Under <strong>Value</strong>, add this widget ID:<br>
            
            <div class="code-block" id="wixWidgetIdDisplay">abc123</div><br>
            
            <strong>9.</strong> <strong>Save</strong> your changes, and hit <strong>Publish</strong>!
        </div>
    </div>
    
    <div style="margin-top: 20px; margin-bottom: 20px; text-align: center;">
        <button onclick="copyInstructionBox('wixWidgetInstructions', this)" style="background: #9c27b0; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px;">
            📋 Copy Instructions for User
        </button>
    </div>

    <div style="margin-bottom: 20px;">
        <strong>Did this solve the issue?</strong>
    </div>

    <div class="options-container">
        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
            <span>✅</span> Yes, widget is working!
        </button>
        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
            <span>❌</span> Still not working
        </button>
    </div>

    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
        <button class="btn btn-primary" id="wixInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
    </div>
</div>

<!-- Other Platform Widget Installation - Placeholder -->
                <div id="step-widget-install-other" class="step-container">
                    <div class="step-title">📝 <span id="widgetTypeDisplayOtherInstall">Button Widget</span> Installation</div>
                    <div class="step-description">Placeholder page for "other" platform widget installation instructions.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">🚧 Coming Soon!</div>
                        <div class="step-item">
                            This page will contain custom widget installation instructions for <span id="otherPlatformNameWidget">[PLATFORM NAME]</span> platforms.
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong>Did this solve the issue?</strong>
                    </div>

                    <div class="options-container">
                        <button class="option-button" onclick="selectWidgetInstallResult('solved')">
                            <span>✅</span> Yes, widget is working!
                        </button>
                        <button class="option-button" onclick="selectWidgetInstallResult('not-solved')">
                            <span>❌</span> Still not working
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="otherInstallResultContinue" onclick="handleWidgetInstallResult()" disabled>Continue →</button>
                    </div>
                </div>

                <!-- Wix Code Collection -->
                <div id="step-wix-code-collection" class="step-container">
                    <div class="step-title">📝 Code Collection</div>
                    
                    <div class="educational-tip-structured">
                        <strong>🕵️ Time for some detective work!</strong> There are two pieces of code for each widget: the <strong>library code</strong> and the <strong>widget code</strong>. We need to confirm that both pieces of code are installed on the user's website.
                            <br><br>
                        <strong>🚗</strong> Think of widgets like a car - you need both the ENGINE (library code) and the STEERING WHEEL (widget code) to get anywhere. Lots of people install one but forget the other!
                    </div>   
                    
                    <div style="color: #666; margin-bottom: 20px;">
                        🚨 Wix is different from other webbuilder installations. They have users install the library code and a unique widget ID at the same time.
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" onclick="nextStep('step-wix-steps-collection')">Collect codes →</button>
                    </div>
                </div>

                <!-- Wix Steps Collection -->
                <div id="step-wix-steps-collection" class="step-container">
                    <div class="step-title">First, we need to collect both their library code and their widget ID#.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">📝 Steps for you:</div>
                        
                        <div class="step-item">
                            <strong>1.</strong> Go to their campaign in their Givebutter dashboard
                        </div>
                        
                        <div class="step-item">
                            <strong>2.</strong> Click on the <strong>Sharing</strong> tab
                        </div>
                        
                        <div class="step-item">
                            <strong>3.</strong> Click <strong>Widgets</strong>
                        </div>
                        
                        <div class="step-item">
                            <strong>4.</strong> Click the blue text that says <strong>Installation</strong>
                            <div style="margin: 15px 0;">
                                <img src="https://i.imgur.com/T8HEVex.png" alt="Installation button location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            </div>
                        </div>
                        
                        <div class="step-item">
                            <strong>5.</strong> Choose <strong>Wix</strong>
                        </div>
                        
                        <div class="step-item">
                            <strong>6.</strong> Close the install page and click on the <strong>Embed</strong> button of the widget they want to install
                        </div>
                        
                        <div class="step-item">
                            <strong>7.</strong> Copy the library code
                            <div style="margin: 15px 0;">
                                <img src="https://i.imgur.com/pLhII0Y.png" alt="Library code location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            </div>
                        </div>
                        
                        <div class="step-item">
                            <strong>8.</strong> Copy the widget ID
                            <div style="margin: 15px 0;">
                                <img src="https://i.imgur.com/RoiqzlM.png" alt="Widget ID location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0 0 0;">
                        <label for="wixLibraryCode" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their library code here:</label>
                        <textarea id="wixLibraryCode" placeholder="Paste the library code here..." class="large-textarea" rows="2" style="margin-bottom: 0; min-height: 60px;" oninput="checkWixCodes()"></textarea>
                        <div id="wixLibraryCodeError" style="color: #c62828; font-size: 0.9em; margin-top: 0; display: none;">
                            ⚠️ Library code should contain widgets.givebutter.com
                        </div>
                    </div>

                    <div style="margin: 20px 0 0 0;">
                        <label for="wixWidgetId" style="font-weight: 600; color: #333; margin-bottom: 10px; display: block;">📋 Paste their widget ID here:</label>
                        <textarea id="wixWidgetId" placeholder="Paste the widget ID here (should be 6 characters: letters and numbers)" class="large-textarea" rows="1" style="min-height: 50px; resize: none; margin-bottom: 0;" oninput="checkWixCodes()"></textarea>
                        <div id="wixWidgetIdError" style="color: #c62828; font-size: 0.9em; margin-top: 0; display: none;">
                            ⚠️ Widget ID should have 6 characters (letters and numbers)
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="wixCodesContinue" onclick="nextStep('step-website-url')" disabled style="opacity: 0.5;">Got the codes →</button>
                    </div>
                </div>

    <!-- Wix Code Inspection -->
                <div id="step-wix-inspection" class="step-container">
                    <div class="step-title">🕵🏽‍♂️ Library Code and Widget Code Inspection</div>
                    <div class="step-description">Time to check if both codes are actually installed on their website.</div>
                    
                    <div class="educational-tip-structured">
                        <div class="step-header">🔍 How to check:</div>
                        
                        <div class="step-item">
                            <strong>1.</strong> Go to <strong id="wixInspectionUrl"></strong>
                        </div>
                        
                        <div class="step-item">
                            <strong>2.</strong> Right-click anywhere on the page and select "Inspect" or "Inspect Element" (or press F12)
                        </div>
                        
                        <div class="step-item">
                            <strong>3.</strong> Select the <strong>Elements</strong> tab.
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <img src="https://i.imgur.com/wWGoMNl.png" alt="Elements tab location" style="width: 100%; max-width: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        </div>
                        
                        <div class="step-item">
                            <strong>4.</strong> Press Ctrl+F (or Cmd+F on Mac) to open the search box
                        </div>
                        
                        <div class="step-item">
                            <strong>5.</strong> Search for: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px;">latest.umd.cjs</code>
                        </div>

                        <div class="step-item">
                            <strong>6.</strong> Now search for their widget ID: <code style="background: #2d3748; color: #e2e8f0; padding: 2px 6px; border-radius: 4px; font-family: monospace;" id="wixWidgetIdSearch">abc123</code>
                        </div>
                    </div>
                    
                    <div class="question">Does anything highlight in yellow or show up in the search results for BOTH searches?</div>
                    
                    <div class="options-container">
                        <button class="option-button" onclick="selectWixCodesFound('found')">
                            <span>✅</span> Found both! 
                        </button>
                        <button class="option-button" onclick="selectWixCodesFound('not-found')">
                            <span>❌</span> One or both missing 
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="goToPreviousStep()">← Back</button>
                        <button class="btn btn-primary" id="wixInspectionContinue" onclick="handleWixInspectionResult()" disabled>Continue →</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Checklist Container -->
        <div class="checklist-container">
            <div class="checklist-header">
                <div class="checklist-title">
                    <span>✅</span>
                    Progress Tracker
                </div>
            </div>

            <div class="checklist-header-divider"></div>

            <div class="checklist-content">
                <div class="checklist-item">
                    <div class="checklist-label">Platform:</div>
                    <div class="checklist-value status-pending" id="checklist-platform">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Plan:</div>
                    <div class="checklist-value status-pending" id="checklist-plan">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Plan is compatible:</div>
                    <div class="checklist-value status-pending" id="checklist-plan-compatible">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Widget type:</div>
                    <div class="checklist-value status-pending" id="checklist-widget-type">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Payouts are set up:</div>
                    <div class="checklist-value status-pending" id="checklist-payouts">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Campaign is published:</div>
                    <div class="checklist-value status-pending" id="checklist-campaign">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Library code:</div>
                    <div class="checklist-value status-pending" id="checklist-library-code">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Website:</div>
                    <div class="checklist-value status-pending" id="checklist-website">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Library code is installed:</div>
                    <div class="checklist-value status-pending" id="checklist-library-installed">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Widget code:</div>
                    <div class="checklist-value status-pending" id="checklist-widget-code">❓</div>
                </div>

                <div class="checklist-item wordpress-only" id="checklist-shortcode-item" style="display: none;">
                    <div class="checklist-label">Shortcode: <span class="platform-specific-label">(WP)</span></div>
                    <div class="checklist-value status-pending" id="checklist-shortcode">❓</div>
                </div>

                <div class="checklist-item wix-only" id="checklist-widget-id-item" style="display: none;">
                    <div class="checklist-label">Widget ID: <span class="platform-specific-label">(Wix)</span></div>
                    <div class="checklist-value status-pending" id="checklist-widget-id">❓</div>
                </div>

                <div class="checklist-item">
                    <div class="checklist-label">Widget code is installed:</div>
                    <div class="checklist-value status-pending" id="checklist-widget-installed">❓</div>
                </div>
            </div>
        </div>
    </div>
            
    <script>

// Checklist hierarchy - defines what gets cleared when going back to each step
        const checklistHierarchy = {
            'step-welcome': [],
            'step-platform': ['plan', 'plan-compatible', 'widget-type', 'payouts', 'campaign', 'library-code', 'website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-plan-check': ['plan-compatible', 'widget-type', 'payouts', 'campaign', 'library-code', 'website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-widget-type': ['payouts', 'campaign', 'library-code', 'website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-payout-check': ['campaign', 'library-code', 'website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-campaign-published': ['library-code', 'website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-code-collection': ['website', 'library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-library-check': ['library-installed', 'widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-widget-code-detection': ['widget-code', 'shortcode', 'widget-id', 'widget-installed'],
            'step-widget-code-detection-wordpress': ['widget-code', 'shortcode', 'widget-installed'],
            'step-website-url': ['widget-installed']
        };
        
        // Global state
        let currentStep = 'step-welcome';
        let wizardData = {
            platform: null,
            plan: null,
            widgetType: null,
            payoutStatus: null,
            campaignStatus: null,
            websiteUrl: null,
            libraryCode: null,
            libraryFound: null,
            compatibilityStatus: null,
            installOption: null,
            platformInstructionChoice: null,
            widgetCode: null,
            widgetFound: null,
            shortcode: null,
            navigationStack: [],
            widgetInstallOption: null,
            widgetInstallResult: null,
            advancedTroubleshootingResult: null,
             wixLibraryCode: null,
            wixWidgetId: null,
            wixCodesFound: null,
        };

        const stepOrder = [
            'step-welcome',
            'step-platform', 
            'step-plan-check',
            'step-widget-type',
            'step-payout-check',
            'step-campaign-published',
            'step-code-collection',
            'step-library-check',
            'step-library-inspection',
             'step-widget-code-detection',
            'step-widget-code-detection-wordpress',
             'step-website-url'
        ];

        // Prevent accidental navigation away from wizard
        window.addEventListener('beforeunload', function(e) {
            // Only show warning if user has made progress past the welcome step
            if (currentStep !== 'step-welcome') {
                e.preventDefault();
                e.returnValue = 'Are you sure you want to leave? Your wizard progress will be lost.';
                return 'Are you sure you want to leave? Your wizard progress will be lost.';
            }
        });

function clearChecklistFrom(stepId) {
            const itemsToClear = checklistHierarchy[stepId] || [];
            
            itemsToClear.forEach(item => {
                const element = document.getElementById(`checklist-${item}`);
                if (element) {
                    element.className = 'checklist-value status-pending';
                    element.textContent = '❓';
                }
            });
            
            // Also clear the corresponding wizardData
            if (itemsToClear.includes('plan')) wizardData.plan = null;
            if (itemsToClear.includes('widget-type')) wizardData.widgetType = null;
            if (itemsToClear.includes('payouts')) wizardData.payoutStatus = null;
            if (itemsToClear.includes('campaign')) wizardData.campaignStatus = null;
            if (itemsToClear.includes('library-code')) wizardData.libraryCode = null;
            if (itemsToClear.includes('website')) wizardData.websiteUrl = null;
            if (itemsToClear.includes('widget-code')) {
                wizardData.widgetCode = null;
                wizardData.shortcode = null;
                wizardData.wixWidgetId = null;
            }
        }
        
        // Checklist update functions
        function updateChecklist(field, value, status = 'dynamic') {
            const element = document.getElementById(`checklist-${field}`);
            if (element) {
                element.className = `checklist-value status-${status}`;
                if (status === 'complete') {
                    element.textContent = '✅';
                } else if (status === 'pending') {
                    element.textContent = '❓';
                } else {
                    element.textContent = value;
                }
            }
        }

        function showPlatformSpecific(platform) {
    const wordpressItem = document.getElementById('checklist-shortcode-item');
    const wixItem = document.getElementById('checklist-widget-id-item');
    
    // Update labels based on platform
    const libraryLabel = document.querySelector('#checklist-library-code').parentElement.querySelector('.checklist-label');
    const libraryInstalledLabel = document.querySelector('#checklist-library-installed').parentElement.querySelector('.checklist-label');
    
    if (platform === 'wordpress') {
        wordpressItem.style.display = 'flex';
        wixItem.style.display = 'none';
        libraryLabel.textContent = 'Account ID:';
        libraryInstalledLabel.textContent = 'Plugin is installed:';
    } else if (platform === 'wix') {
        wordpressItem.style.display = 'none';
        wixItem.style.display = 'flex';
        libraryLabel.textContent = 'Library code:';
        libraryInstalledLabel.textContent = 'Library code is installed:';
    } else {
        wordpressItem.style.display = 'none';
        wixItem.style.display = 'none';
        libraryLabel.textContent = 'Library code:';
        libraryInstalledLabel.textContent = 'Library code is installed:';
    }
}

        // Navigation functions
        function nextStep(stepId) {
            wizardData.navigationStack.push(currentStep);
            document.getElementById(currentStep).classList.remove('active');
            document.getElementById(stepId).classList.add('active');
            currentStep = stepId;
            updateNavButtons();
        }

        function previousStep(stepId) {
            // Clear downstream checklist items when going back
            clearChecklistFrom(stepId);
            
            document.getElementById(currentStep).classList.remove('active');
            document.getElementById(stepId).classList.add('active');
            currentStep = stepId;
            updateNavButtons();
        }
        
       function goToPreviousStep() {
    // Pop the last step from navigation stack
    const previousStepId = wizardData.navigationStack.pop();
    
    if (previousStepId) {
        // Clear downstream checklist items when going back
        clearChecklistFrom(previousStepId);
        
        document.getElementById(currentStep).classList.remove('active');
        document.getElementById(previousStepId).classList.add('active');
        currentStep = previousStepId;
        updateNavButtons();
    }
}

        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const currentIndex = stepOrder.indexOf(currentStep);
            if (prevBtn) {
                prevBtn.disabled = (currentIndex <= 0 || currentStep === 'step-welcome');
            }
        }

        function restartWizard() {
            wizardData = {
                platform: null,
                plan: null,
                widgetType: null,
                payoutStatus: null,
                campaignStatus: null,
                websiteUrl: null,
                libraryCode: null,
                libraryFound: null,
                compatibilityStatus: null,
                installOption: null,
                platformInstructionChoice: null,
                widgetCode: null,
                widgetFound: null,
                shortcode: null,
                navigationStack: [],
                widgetInstallOption: null,
                widgetInstallResult: null,
                advancedTroubleshootingResult: null,
                 wixLibraryCode: null,
                wixWidgetId: null,
                wixCodesFound: null,
                otherPlatformName: null,         
                otherPlatformResourceUrl: null, 
                otherPlatformResult: null 
            };
            
            // Reset all checklist items
            const checklistItems = document.querySelectorAll('[id^="checklist-"]');
            checklistItems.forEach(item => {
                item.className = 'checklist-value status-pending';
                item.textContent = '❓';
            });
            
            // Hide platform-specific items
            document.getElementById('checklist-shortcode-item').style.display = 'none';
            document.getElementById('checklist-widget-id-item').style.display = 'none';

            // Clear all input fields
const inputFields = [
    'websiteUrl',
    'widgetWebsiteUrl', 
    'userWidgetCode',
    'userWidgetCodeWordpress',
    'userShortcode',
    'libraryCode',
    'wordpressAccountId',
    'wixLibraryCode',
    'wixWidgetId',
    'otherPlatformUrl'
];

inputFields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    if (field) {
        field.value = '';
    }
});

// Clear all checkboxes
const checkboxes = [
    'libraryConfirmed',
    'widgetConfirmed', 
    'wordpressWidgetConfirmed',
    'skipCheck'
];

checkboxes.forEach(checkboxId => {
    const checkbox = document.getElementById(checkboxId);
    if (checkbox) {
        checkbox.checked = false;
    }
});
            
            nextStep('step-welcome');
        }

        function exitWizard() {
            if (confirm('Are you sure you want to exit the Widget Wizard?')) {
                alert('👋 Thanks for using the Widget Wizard! You\'ll return to the main SALT interface.');
            }
        }


        // Platform selection functions
        function selectPlatform(platform) {
            document.querySelectorAll('#step-platform .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            const button = event.target.closest('.option-button');
            if (button) {
                button.classList.add('selected');
            }
            wizardData.platform = platform;
            
            // Update checklist
            updateChecklist('platform', getPlatformDisplayName(platform));
            showPlatformSpecific(platform);
            
            document.getElementById('platformContinue').disabled = false;

            if (['wordpress', 'squarespace', 'wix', 'godaddy', 'weebly'].includes(platform)) {
                document.getElementById('skipCompatibilityCheck').style.display = 'flex';
            }
        }

        function checkPlatformPlan() {
            if (wizardData.platform === 'other') {
                const platformName = prompt('What website builder are they using?');
                if (platformName) {
                    wizardData.otherPlatformName = platformName;
                    
                    // Update checklist with custom platform name
                    updateChecklist('platform', platformName);
                    
                    document.getElementById('otherPlatformNameDisplay').textContent = platformName;
                    document.getElementById('otherPlatformNameChatGPT').textContent = platformName;
                    document.querySelectorAll('.otherPlatformName').forEach(span => {
                        span.textContent = platformName;
                    });
                    
                    nextStep('step-other-research');
                    return;
                }
            }

            if (wizardData.platform === 'google') {
                nextStep('step-google-incompatible');
                return;
            }
            
            if (wizardData.platform === 'shopify') {
                nextStep('step-shopify-incompatible');
                return;
            }

            if (wizardData.platform === 'weebly' || wizardData.platform === 'godaddy') {
                updateChecklist('plan', 'all plans compatible');
                updateChecklist('plan-compatible', '', 'complete');
                nextStep('step-widget-type');
                return;
            }
            
            const skipCheck = document.getElementById('skipCheck');
            if (skipCheck && skipCheck.checked) {
                updateChecklist('plan', 'confirmed compatible');
                updateChecklist('plan-compatible', '', 'complete');
                nextStep('step-widget-type');
                return;
            }
            
            setupPlanCheck();
            nextStep('step-plan-check');
        }

        function showIncompatibleFromResearch() {
            const platformName = wizardData.otherPlatformName;
            document.getElementById('genericIncompatibleMessage').textContent = 
                `"After checking, I confirmed that ${platformName} doesn't currently support Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. 😊 Would you like directions on how to do that?"`;
            nextStep('step-generic-incompatible');
        }

        function setupPlanCheck() {
            const planOptions = document.getElementById('planOptions');
            const planQuestion = document.getElementById('planQuestion');
            const planDescription = document.getElementById('planCheckDescription');
            
            planOptions.innerHTML = '';
            
            switch (wizardData.platform) {
                case 'wordpress':
                    planQuestion.textContent = 'What WordPress plan do they have?';
                    planDescription.textContent = 'Widgets need the ability to install plugins or add custom code.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                                <button class="option-button" onclick="selectPlan('personal')">
                                    Personal plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('business')">
                                    Business plan
                                </button>
                               <button class="option-button compatible" onclick="selectPlan('ecommerce')">
                                    eCommerce plan
                                </button>
                            <button class="option-button compatible" onclick="selectPlan('wordpress-org')">
                                    WordPress.org
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'squarespace':
                    planQuestion.textContent = 'What Squarespace plan do they have?';
                    planDescription.textContent = 'Widgets need Code Injection access.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('basic')">
                                    Basic plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('core')">
                                    Core plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('plus')">
                                    Plus plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('advanced')">
                                    Advanced plan
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'wix':
                    planQuestion.textContent = 'Do they have a premium Wix plan with a custom domain (no ads)?';
                    planDescription.textContent = 'Widgets need the Custom Element feature.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('light')">
                                    Light plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('core')">
                                    Core plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('business')">
                                    Business plan
                                </button>
                                <button class="option-button compatible" onclick="selectPlan('businesselite')">
                                    Business Elite plan
                                </button>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    planQuestion.textContent = 'What plan level do they have?';
                    planDescription.textContent = 'Let\'s verify they have the right plan for custom code.';
                    planOptions.innerHTML = `
                        <div class="compatibility-section">
                            <div class="compatibility-header not-compatible">Plans that aren't compatible:</div>
                            <div class="options-container">
                                <button class="option-button" onclick="selectPlan('free')">
                                    Free plan
                                </button>
                            </div>
                        </div>
                        <div class="compatibility-section">
                            <div class="compatibility-header compatible">Plans that are compatible:</div>
                            <div class="options-container">
                                <button class="option-button compatible" onclick="selectPlan('premium')">
                                    Premium/Paid plan
                                </button>
                            </div>
                        </div>
                    `;
            }
        }

        function selectPlan(plan) {
            document.querySelectorAll('#step-plan-check .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            const buttons = document.querySelectorAll('#step-plan-check .option-button');
            buttons.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(plan.toLowerCase()) || 
                    (plan === 'business' && btn.textContent.includes('Business') && !btn.textContent.includes('Elite')) ||
                    (plan === 'businesselite' && btn.textContent.includes('Business Elite')) ||
                    (plan === 'ecommerce' && btn.textContent.includes('eCommerce')) ||
                    (plan === 'wordpress-org' && btn.textContent.includes('WordPress.org')) ||
                    (plan === 'personal' && btn.textContent.includes('Personal')) ||
                    (plan === 'free' && btn.textContent.includes('Free')) ||
                    (plan === 'premium' && btn.textContent.includes('Premium'))) {
                    btn.classList.add('selected');
                }
            });
            
            wizardData.plan = plan;
            
            // Update checklist
            updateChecklist('plan', getPlanDisplayName(plan));
            
            document.getElementById('planContinue').disabled = false;
        }

        function checkPlanCompatibility() {
            const selectedButton = document.querySelector('#step-plan-check .option-button.selected');
            
            if (!selectedButton) {
                console.error('No plan selected!');
                return;
            }
            
            const isCompatible = selectedButton.classList.contains('compatible');
            
            if (isCompatible) {
                updateChecklist('plan-compatible', '', 'complete');
                nextStep('step-widget-type');
            } else {
                showIncompatible();
            }
        }
        
        function showIncompatible() {
            const incompatibleMessage = document.getElementById('incompatibleMessage');
            const platformName = getPlatformDisplayName(wizardData.platform);
            
            if (['free', 'personal', 'basic'].includes(wizardData.plan)) {
                const requiredPlan = getRequiredPlan(wizardData.platform);
                incompatibleMessage.textContent = `"After checking, it looks like you need to be on the ${requiredPlan} plan with ${platformName} to use Givebutter widgets. But don't worry - you can still share your campaign link directly on your website and on social media. 😊 Would you like directions on how to do that?"`;
            }
            
            nextStep('step-incompatible');
        }
        
        function getPlatformDisplayName(platform) {
            const names = {
                'wordpress': 'WordPress',
                'squarespace': 'Squarespace',
                'wix': 'Wix',
                'godaddy': 'GoDaddy',
                'weebly': 'Weebly',
                'google': 'Google',
                'shopify': 'Shopify'
            };
            return names[platform] || platform;
        }

        function getPlanDisplayName(plan) {
            const names = {
                'free': 'Free plan',
                'personal': 'Personal plan', 
                'basic': 'Basic plan',
                'business': 'Business plan',
                'ecommerce': 'eCommerce plan',
                'wordpress-org': 'WordPress.org',
                'core': 'Core plan',
                'plus': 'Plus plan',
                'advanced': 'Advanced plan',
                'light': 'Light plan',
                'businesselite': 'Business Elite plan',
                'premium': 'Premium plan'
            };
            return names[plan] || plan;
        }

        function getRequiredPlan(platform) {
            const plans = {
                'wordpress': 'Business or eCommerce',
                'squarespace': 'Core, Plus, or Advanced',
                'wix': 'Light, Core, Business, or Business Elite'
            };
            return plans[platform] || 'Premium';
        }

        // Widget type selection
        function selectWidgetType(type) {
            document.querySelectorAll('#step-widget-type .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.widgetType = type;
            
            // Update checklist
            updateChecklist('widget-type', getWidgetTypeDisplayName(type));
            
            document.getElementById('widgetTypeContinue').disabled = false;
        }

        function handleWidgetTypeSelection() {
    // Update widget type display throughout the wizard
    const widgetTypeText = getWidgetTypeDisplayName(wizardData.widgetType);
    document.querySelectorAll('#widgetTypeDisplay, #widgetTypeDisplay2, #widgetTypeDisplay3, #widgetTypeDisplay4, #widgetTypeDisplayURL, #widgetTypeDisplayInspection, #widgetTypeDisplayInstallChoice, #widgetTypeDisplayInstallChoice2, #widgetTypeDisplayWPInstall, #widgetTypeDisplayWPInstall2, #widgetTypeDisplaySSInstall, #widgetTypeDisplaySSInstall2, #widgetTypeDisplayGDInstall, #widgetTypeDisplayGDInstall2, #widgetTypeDisplayWeeblyInstall, #widgetTypeDisplayWeeblyInstall2, #widgetTypeDisplayWixInstall, #widgetTypeDisplayWixInstall2').forEach(element => {
        element.textContent = widgetTypeText;
    });
    
    if (wizardData.widgetType === 'signup') {
        nextStep('step-code-collection');
    } else {
        // Set platform name (handles both regular platforms and "other")
        const displayName = wizardData.platform === 'other' ? 
            wizardData.otherPlatformName : 
            getPlatformDisplayName(wizardData.platform);
        document.getElementById('platformName').textContent = displayName;
        nextStep('step-payout-check');
    }
}

function getWidgetTypeDisplayName(type) {
    const names = {
        'button': 'Button Widget',
        'form': 'Form Widget',
        'goalbar': 'Goal Bar Widget',
        'signup': 'Signup Form Widget'
    };
    return names[type] || 'Widget';
}

        // Payout status functions
        function selectPayoutStatus(status) {
            document.querySelectorAll('#step-payout-check .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.payoutStatus = status;
            document.getElementById('payoutStatusContinue').disabled = false;
        }

        function handlePayoutStatus() {
            if (wizardData.payoutStatus === 'not-connected') {
                nextStep('step-payout-solution');
            } else {
                // Update checklist
                updateChecklist('payouts', '', 'complete');
                nextStep('step-campaign-published');
            }
        }

        // Campaign status functions
        function selectCampaignStatus(status) {
            document.querySelectorAll('#step-campaign-published .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.campaignStatus = status;
            document.getElementById('campaignStatusContinue').disabled = false;
        }

        function handleCampaignStatus() {
    if (wizardData.campaignStatus === 'unpublished') {
        nextStep('step-unpublished-solution');
    } else {
        // Update checklist
        updateChecklist('campaign', '', 'complete');
        
        // Check if platform is Wix - they get special flow
        if (wizardData.platform === 'wix') {
            nextStep('step-wix-code-collection');
        } else {
            nextStep('step-code-collection');
        }
    }
}

function handleCampaignPublished() {
    // Update checklist to show campaign is now published
    updateChecklist('campaign', '', 'complete');
    
    // Continue to next step
    if (wizardData.platform === 'wix') {
        nextStep('step-wix-code-collection');
    } else {
        nextStep('step-code-collection');
    }
}

        // Compatibility selection functions
        function selectCompatibility(status) {
            document.querySelectorAll('#step-other-research .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.compatibilityStatus = status;
            document.getElementById('compatibilityContinue').disabled = false;
        }

        function handleCompatibilitySelection() {
    if (wizardData.compatibilityStatus === 'compatible') {
        updateChecklist('plan', 'all plans compatible');
        updateChecklist('plan-compatible', '', 'complete');
        
        // Go to widget type selection like other platforms
        nextStep('step-widget-type');
    } else {
        showIncompatibleFromResearch();
    }
}

// Other platform functions
function checkOtherPlatformUrl() {
    const url = document.getElementById('otherPlatformUrl').value.trim();
    const continueBtn = document.getElementById('otherPlatformUrlContinue');
    
    if (url && url.includes('http')) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
        wizardData.otherPlatformResourceUrl = url;
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
    }
}

function proceedToOtherPlatformInstructions() {
    const url = document.getElementById('otherPlatformUrl').value.trim();
    wizardData.otherPlatformResourceUrl = url;
    
    // Set up the library code collection page for "other" platform
    document.getElementById('selectedPlatformName').textContent = 'I use another platform';
    
    // Go to library code collection first
    nextStep('step-get-library-code');
}

function selectOtherPlatformResult(result) {
    document.querySelectorAll('#step-other-platform-instructions .option-button').forEach(btn => {
        btn.classList.remove('selected');
    });
    
    event.target.closest('.option-button').classList.add('selected');
    wizardData.otherPlatformResult = result;
    document.getElementById('otherPlatformResultContinue').disabled = false;
}

function handleOtherPlatformResult() {
    if (wizardData.otherPlatformResult === 'solved') {
        // Update checklist - library code is installed
        updateChecklist('library-installed', '', 'complete');
        markProblemSolved('other-platform-library-installed');
    } else {
        // Library was installed but still not working - need widget code troubleshooting
        updateChecklist('library-installed', '', 'complete');
        nextStep('step-widget-code-detection');
    }
}

        function toggleLibraryConfirmed() {
    const checkbox = document.getElementById('libraryConfirmed');
    const continueButton = document.getElementById('libraryCheckButton');
    
    if (checkbox.checked) {
        // Update checklist when checkbox is checked
        updateChecklist('library-installed', '', 'complete');
        
        continueButton.textContent = 'Continue →';
        if (wizardData.platform === 'wordpress') {
            continueButton.onclick = function() { nextStep('step-widget-code-detection-wordpress'); };
        } else {
            continueButton.onclick = function() { nextStep('step-widget-code-detection'); };
        }
    } else {
        // Reset checklist when unchecked
        updateChecklist('library-installed', '❓', 'pending');
        
        continueButton.textContent = 'Check Library Code →';
        continueButton.onclick = function() { nextStep('step-library-check'); };
    }
}

        function checkUrlInput() {
    const url = document.getElementById('websiteUrl').value.trim();
    const continueBtn = document.getElementById('urlContinue');
    
    // Always enable continue button if they've typed something
    if (url) {
        continueBtn.disabled = false;
    } else {
        continueBtn.disabled = true;
    }
}

       function startLibraryInspection() {
    let url = document.getElementById('websiteUrl').value.trim();
    
    // Add https:// if no protocol is present
    if (url && !url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
    }
    
    wizardData.websiteUrl = url;
    
    // Update checklist
    updateChecklist('website', url);
    
    const inspectionUrlElement = document.getElementById('inspectionUrl');
    inspectionUrlElement.innerHTML = `<a href="${url}" target="_blank" style="color: #9c27b0; font-weight: 600; text-decoration: underline;">${url}</a>`;
    nextStep('step-library-inspection');
}

        function selectLibraryFound(status) {
            document.querySelectorAll('#step-library-inspection .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.libraryFound = status;
            document.getElementById('libraryFoundContinue').disabled = false;
        }

       function handleLibraryResult() {
    if (wizardData.libraryFound === 'found') {
        // Update checklist
        updateChecklist('library-installed', '', 'complete');
        
        if (wizardData.platform === 'wordpress') {
            nextStep('step-widget-code-detection-wordpress');
        } else {
            nextStep('step-widget-code-detection');
        }
    } else {
        // Wix is special - library and widget code install together
        if (wizardData.platform === 'wix') {
            nextStep('step-wix-install');
        } else {
            nextStep('step-library-install');
        }
    }
}

function handleLibraryInstallContinue(nextStepId) {
    // Update checklist to show library code is installed
    updateChecklist('library-installed', '', 'complete');
    
    // Continue to the specified next step
    nextStep(nextStepId);
}

// Widget inspection functions
        function selectWidgetFound(status) {
            document.querySelectorAll('#step-widget-inspection .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.closest('.option-button').classList.add('selected');
            wizardData.widgetFound = status;
            document.getElementById('widgetFoundContinue').disabled = false;
        }

        function handleWidgetResult() {
    if (wizardData.widgetFound === 'found') {
        // Update checklist - widget code is installed
        updateChecklist('widget-installed', '', 'complete');
        // Widget is installed but still not working - go to advanced troubleshooting
        nextStep('step-advanced-troubleshooting');
    } else {
        nextStep('step-widget-install-choice');
    }
}

        function goBackFromWidgetInspection() {
            // Check if they came from widget code detection or website URL collection
            if (wizardData.websiteUrl && document.getElementById('libraryConfirmed') && document.getElementById('libraryConfirmed').checked) {
                // They skipped library check, came from widget code detection
                if (wizardData.platform === 'wordpress') {
                    previousStep('step-widget-code-detection-wordpress');
                } else {
                    previousStep('step-widget-code-detection');
                }
            } else {
                // They came from website URL collection
                previousStep('step-website-url');
            }
        }

function setupWidgetInspection() {
            // Set the website URL
            const widgetInspectionUrlElement = document.getElementById('widgetInspectionUrl');
            widgetInspectionUrlElement.innerHTML = `<a href="${wizardData.websiteUrl}" target="_blank" style="color: #9c27b0; font-weight: 600; text-decoration: underline;">${wizardData.websiteUrl}</a>`;
            
            // Extract and set the widget search term from the widget code
            const widgetCode = wizardData.widgetCode;
            if (widgetCode) {
                // Extract the ID from something like: <givebutter-widget id="abc123">
                const idMatch = widgetCode.match(/id="([^"]+)"/);
                if (idMatch) {
                    const widgetId = idMatch[1];
                    document.getElementById('widgetSearchTerm').textContent = `givebutter-widget id="${widgetId}"`;
                }
            }
            
            // Show shortcode search step only for WordPress
            const shortcodeStep = document.getElementById('shortcodeSearchStep');
            if (wizardData.platform === 'wordpress' && wizardData.shortcode) {
                shortcodeStep.style.display = 'block';
                // Extract and set shortcode search term
                const shortcodeMatch = wizardData.shortcode.match(/\[givebutter[^\]]+\]/);
                if (shortcodeMatch) {
                    document.getElementById('shortcodeSearchTerm').textContent = shortcodeMatch[0];
                }
            } else {
                shortcodeStep.style.display = 'none';
            }
        }

// Wix inspection functions
        function setupWixInspection() {
            // Set the website URL
            const wixInspectionUrlElement = document.getElementById('wixInspectionUrl');
            wixInspectionUrlElement.innerHTML = `<a href="${wizardData.websiteUrl}" target="_blank" style="color: #9c27b0; font-weight: 600; text-decoration: underline;">${wizardData.websiteUrl}</a>`;
            
            // Set the widget ID search term from collected data
            if (wizardData.wixWidgetId) {
                document.getElementById('wixWidgetIdSearch').textContent = wizardData.wixWidgetId;
            }
        }

        function selectWixCodesFound(status) {
            document.querySelectorAll('#step-wix-inspection .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.closest('.option-button').classList.add('selected');
            wizardData.wixCodesFound = status;
            document.getElementById('wixInspectionContinue').disabled = false;
        }

        function handleWixInspectionResult() {
            if (wizardData.wixCodesFound === 'found') {
                // Update checklist - for Wix both get checked together
                updateChecklist('library-installed', '', 'complete');
                updateChecklist('widget-installed', '', 'complete');
                markProblemSolved('wix-codes-working');
        } else {
                // Need to install Wix codes - go directly to installation
                setupWidgetInstallation();
                nextStep('step-widget-install-wix');
                }
        }

// Widget installation functions
        function selectWidgetInstallOption(option) {
            document.querySelectorAll('#step-widget-install-choice .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.closest('.option-button').classList.add('selected');
            wizardData.widgetInstallOption = option;
            document.getElementById('widgetInstallChoiceContinue').disabled = false;
        }

        function handleWidgetInstallChoice() {
    if (wizardData.widgetInstallOption === 'step-by-step') {
        // Route to platform-specific installation page
        setupWidgetInstallation();
        const platform = wizardData.platform;
        if (platform === 'wordpress') {
            nextStep('step-widget-install-wordpress');
        } else if (platform === 'squarespace') {
            nextStep('step-widget-install-squarespace');
        } else if (platform === 'godaddy') {
            nextStep('step-widget-install-godaddy');
        } else if (platform === 'weebly') {
            nextStep('step-widget-install-weebly');
        } else if (platform === 'wix') {
            nextStep('step-widget-install-wix');
        } else if (platform === 'other') {
            // TODO: Create step-widget-install-other page
            nextStep('step-widget-install-other');
        }
    } else {
        // Send instructions - assume widget code is installed and go to advanced troubleshooting
        updateChecklist('widget-installed', '', 'complete');
        nextStep('step-advanced-troubleshooting');
    }
}

        function setupWidgetInstallation() {
            const widgetCode = wizardData.widgetCode;
            const shortcode = wizardData.shortcode;
            
            // Populate widget code displays for all platforms
            if (widgetCode) {
                document.getElementById('wordpressWidgetCodeDisplay').textContent = widgetCode;
                document.getElementById('squarespaceWidgetCodeDisplay').textContent = widgetCode;
                document.getElementById('godaddyWidgetCodeDisplay').textContent = widgetCode;
                document.getElementById('weeblyWidgetCodeDisplay').textContent = widgetCode;
            }
            
            // Populate shortcode display for WordPress
            if (shortcode) {
                document.getElementById('wordpressShortcodeDisplay').textContent = shortcode;
            }
            
            // Populate Wix data displays
            if (wizardData.wixLibraryCode) {
                document.getElementById('wixLibraryCodeDisplay').textContent = wizardData.wixLibraryCode;
            }
            if (wizardData.wixWidgetId) {
                document.getElementById('wixWidgetIdDisplay').textContent = wizardData.wixWidgetId;
            }
        }

        function selectWidgetInstallResult(result) {
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.closest('.option-button').classList.add('selected');
            wizardData.widgetInstallResult = result;
            
            // Enable the appropriate continue button based on current step
            const currentStepId = currentStep;
            if (currentStepId.includes('wordpress')) {
                document.getElementById('wordpressInstallResultContinue').disabled = false;
            } else if (currentStepId.includes('squarespace')) {
                document.getElementById('squarespaceInstallResultContinue').disabled = false;
            } else if (currentStepId.includes('godaddy')) {
                document.getElementById('godaddyInstallResultContinue').disabled = false;
            } else if (currentStepId.includes('weebly')) {
                document.getElementById('weeblyInstallResultContinue').disabled = false;
            } else if (currentStepId.includes('wix')) {
                document.getElementById('wixInstallResultContinue').disabled = false;
            }
        }

        function handleWidgetInstallResult() {
    // Always update checklist - if they got this far, widget code was installed
    updateChecklist('widget-installed', '', 'complete');
    
    // For Wix, also mark library as installed since they install together
    if (wizardData.platform === 'wix') {
        updateChecklist('library-installed', '', 'complete');
    }
    
    if (wizardData.widgetInstallResult === 'solved') {
        markProblemSolved('widget-installed');
    } else {
        // Widget was installed but still not working - go to advanced troubleshooting
        nextStep('step-advanced-troubleshooting');
    }
}
        
        function checkLibraryCode() {
    const code = document.getElementById('libraryCode').value.trim();
    const continueBtn = document.getElementById('libraryCodeContinue');
    
    if (code && code.includes('widgets.givebutter.com')) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
        wizardData.libraryCode = code;
        
        // Update checklist
        updateChecklist('library-code', code);
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
    }
}

        function selectInstallOption(option) {
            document.querySelectorAll('#step-library-install .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.installOption = option;
            document.getElementById('installOptionContinue').disabled = false;
        }

     function handleInstallOption() {
    if (wizardData.installOption === 'step-by-step') {
        if (wizardData.platform === 'wordpress') {
            nextStep('step-get-library-code-wordpress');
        } else if (wizardData.platform === 'other') {
            // Set up platform names for research page
            document.getElementById('otherPlatformNameResearch').textContent = wizardData.otherPlatformName;
            document.getElementById('otherPlatformNameGoogle').textContent = wizardData.otherPlatformName;
            document.getElementById('otherPlatformNameInstructions').textContent = wizardData.otherPlatformName;
            
            // Go to research page for "other" platforms
            nextStep('step-other-platform-research');
        } else {
            // Set the platform name for the library code page
            document.getElementById('selectedPlatformName').textContent = getPlatformDisplayName(wizardData.platform);
            nextStep('step-get-library-code');
        }
    } else {
        // They chose "Check widget code" - assume library is installed
        updateChecklist('library-installed', '', 'complete');
        
        if (wizardData.platform === 'wordpress') {
            nextStep('step-widget-code-detection-wordpress');
        } else {
            nextStep('step-widget-code-detection');
        }
    }
}

        function selectPlatformInstructionChoice(choice) {
            document.querySelectorAll('#step-platform-instructions .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            wizardData.platformInstructionChoice = choice;
            document.getElementById('platformInstructionsContinue').disabled = false;
        }

        function handlePlatformInstructions() {
    if (wizardData.platformInstructionChoice === 'solved') {
        // Update checklist
        updateChecklist('library-installed', '', 'complete');
        markProblemSolved('library-installed');
    } else {
        // Update checklist that library code is installed  
        updateChecklist('library-installed', '', 'complete');
        
        if (wizardData.platform === 'wordpress') {
            nextStep('step-widget-code-detection-wordpress');
        } else {
            nextStep('step-widget-code-detection');
        }
    }
}
        function showPlatformInstructions() {
    const platform = wizardData.platform;
    const libraryCode = document.getElementById('libraryCode').value.trim();
    wizardData.libraryCode = libraryCode;

// Handle other platforms first
    if (platform === 'other') {
        const url = wizardData.otherPlatformResourceUrl;
        const platformName = wizardData.otherPlatformName;
        
        // Update the instructions page with collected data
        document.getElementById('otherPlatformNameInstructionsFinal').textContent = platformName;
        document.getElementById('otherPlatformResourceLink').href = url;
        document.getElementById('otherPlatformResourceLink').textContent = url;
        document.getElementById('otherPlatformLibraryCodeDisplay').textContent = libraryCode;
        
        nextStep('step-other-platform-instructions');
        return;
    }
    
    // Route to platform-specific pages
    if (platform === 'squarespace') {
        document.getElementById('squarespaceLibraryCodeDisplay').textContent = libraryCode;
        nextStep('step-get-library-code-squarespace');
        return;
    }
    
    if (platform === 'godaddy') {
        // Will route to step-get-library-code-godaddy when that page is created
        document.getElementById('godaddyLibraryCodeDisplay').textContent = libraryCode;
        nextStep('step-get-library-code-godaddy');
        return;
    }
    
    if (platform === 'weebly') {
        // Will route to step-get-library-code-weebly when that page is created
        document.getElementById('weeblyLibraryCodeDisplay').textContent = libraryCode;
        nextStep('step-get-library-code-weebly');
        return;
    }
    
    // For other platforms, use the generic platform instructions page
    const instructionsContent = document.getElementById('platformInstructionsContent');
    const libraryCodeDisplay = document.getElementById('libraryCodeDisplay');
    
    document.getElementById('selectedPlatformName').textContent = getPlatformDisplayName(platform);
    libraryCodeDisplay.textContent = libraryCode;
    
    // Simple generic instructions for other platforms
    const instructions = `
        <em>To install the library on your webpage:</em><br>
        Please refer to your website builder's documentation for adding custom HTML/JavaScript code to the header section of your site.
    `;
    
    instructionsContent.innerHTML = instructions;
    nextStep('step-platform-instructions');
}
// WordPress-specific functions
function checkWordPressAccountId() {
    const accountId = document.getElementById('wordpressAccountId').value.trim();
    const continueBtn = document.getElementById('wordpressContinueBtn');
    
    if (accountId) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
        // Update checklist with Account ID for WordPress
        updateChecklist('library-code', accountId);
    }
}

function showWordPressPage1() {
    document.getElementById('wordpress-page1').style.display = 'block';
    document.getElementById('wordpress-page2').style.display = 'none';
}

function showWordPressPage2() {
    const accountId = document.getElementById('wordpressAccountId').value.trim();
    document.getElementById('wordpressDisplayAccountId').textContent = accountId;

    // Update checklist with the Account ID
    updateChecklist('library-code', accountId);
    
    document.getElementById('wordpress-page1').style.display = 'none';
    document.getElementById('wordpress-page2').style.display = 'block';
}
    
function copyInstructionBox(containerId, buttonElement) {
    const container = document.getElementById(containerId);
    if (!container) {
        console.error('Container not found:', containerId);
        return;
    }
    
    // Get HTML content and clean it up
    let htmlContent = container.innerHTML;
    
    // Simple cleanup for Intercom compatibility
    htmlContent = htmlContent
        // Convert code blocks to strong tags
        .replace(/<div class="code-block"[^>]*>(.*?)<\/div>/gs, '<strong>$1</strong>')
        // Replace any existing div/p tags with single spaces first
        .replace(/<\/?(div|p)[^>]*>/g, ' ')
        // Clean up ALL whitespace 
        .replace(/\s+/g, ' ')
        .trim()
        // Now add single breaks before each number
        .replace(/(\d+\.)/g, '<br>$1')
        // Remove any leading <br>
        .replace(/^<br>/, '');
    
    // Copy both formats
    if (navigator.clipboard && window.ClipboardItem) {
        navigator.clipboard.write([
            new ClipboardItem({
                'text/html': new Blob([htmlContent], {type: 'text/html'}),
                'text/plain': new Blob([container.textContent], {type: 'text/plain'})
            })
        ]);
    } else {
        navigator.clipboard.writeText(container.textContent);
    }
    
    // Button feedback
    const originalText = buttonElement.innerHTML;
    buttonElement.innerHTML = '✅ Copied!';
    buttonElement.style.background = '#4CAF50';
    
    setTimeout(() => {
        buttonElement.innerHTML = originalText;
        buttonElement.style.background = '#9c27b0';
    }, 2000);
}
        
function toggleWidgetConfirmed() {
    const checkbox = document.getElementById('widgetConfirmed');
    const continueButton = document.getElementById('widgetCodeContinue');
    
    if (checkbox.checked) {
        // Update checklist when checkbox is checked
        updateChecklist('widget-installed', '', 'complete');
        
        continueButton.textContent = 'Continue →';
        continueButton.disabled = false;
        continueButton.style.opacity = '1';
        continueButton.onclick = function() { nextStep('step-advanced-troubleshooting'); };
    } else {
        // Reset checklist when unchecked
        updateChecklist('widget-installed', '❓', 'pending');
        
        continueButton.textContent = 'Got the widget code →';
        continueButton.onclick = function() { proceedToWidgetSearch(); };
        // Reset to original state - check if they have widget code
        const code = document.getElementById('userWidgetCode').value.trim();
        if (code && code.includes('givebutter-widget')) {
            continueButton.disabled = false;
            continueButton.style.opacity = '1';
        } else {
            continueButton.disabled = true;
            continueButton.style.opacity = '0.5';
        }
    }
}

function toggleWordpressWidgetConfirmed() {
    const checkbox = document.getElementById('wordpressWidgetConfirmed');
    const continueButton = document.getElementById('wordpressWidgetCodeContinue');
    
    if (checkbox.checked) {
        // Update checklist when checkbox is checked
        updateChecklist('widget-installed', '', 'complete');
        
        continueButton.textContent = 'Continue →';
        continueButton.disabled = false;
        continueButton.style.opacity = '1';
        continueButton.onclick = function() { nextStep('step-advanced-troubleshooting'); };
    } else {
        // Reset checklist when unchecked
        updateChecklist('widget-installed', '❓', 'pending');
        
        continueButton.textContent = 'Got the widget code →';
        // Reset to original state - check if they have both widget code and shortcode
        const widgetCode = document.getElementById('userWidgetCodeWordpress').value.trim();
        const shortcode = document.getElementById('userShortcode').value.trim();
        const widgetCodeValid = widgetCode && widgetCode.includes('givebutter-widget');
        const shortcodeValid = shortcode && shortcode.includes('[givebutter');
        
        if (widgetCodeValid && shortcodeValid) {
            continueButton.disabled = false;
            continueButton.style.opacity = '1';
        } else {
            continueButton.disabled = true;
            continueButton.style.opacity = '0.5';
        }
        continueButton.onclick = function() { proceedToWordpressWidgetSearch(); };
    }
}
        
function selectAdvancedTroubleshootingResult(result) {
            document.querySelectorAll('#step-advanced-troubleshooting .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            event.target.closest('.option-button').classList.add('selected');
            wizardData.advancedTroubleshootingResult = result;
            document.getElementById('advancedTroubleshootingContinue').disabled = false;
        }

        function handleAdvancedTroubleshootingResult() {
    if (wizardData.advancedTroubleshootingResult === 'solved') {
        markProblemSolved('advanced-troubleshooting-solved');
    } else {
        nextStep('step-create-linear-ticket');
    }
}
        
        function markProblemSolved(solutionType) {
            // Go directly to success page - the success page has its own messaging
            nextStep('step-problem-solved');
        }

function copyProgressTracker(buttonElement) {
    // Read directly from the checklist display to get all current values
    const getChecklistValue = (id) => {
        const element = document.getElementById(`checklist-${id}`);
        return element ? element.textContent.trim() : 'Not set';
    };
    
    const getChecklistStatus = (id) => {
        const element = document.getElementById(`checklist-${id}`);
        if (!element) return 'Not checked';
        
        if (element.classList.contains('status-complete')) {
            return '✅';
        } else if (element.classList.contains('status-dynamic')) {
            return element.textContent.trim();
        } else {
            return '❓ Not checked';
        }
    };
    
    // Special handling for library code to preserve HTML formatting
    const getLibraryCode = () => {
        if (wizardData.libraryCode) {
            return wizardData.libraryCode;
        } else if (wizardData.wixLibraryCode) {
            return wizardData.wixLibraryCode;
        } else {
            return getChecklistValue('library-code');
        }
    };
    
    // Special handling for widget code to preserve HTML formatting
    const getWidgetCode = () => {
        if (wizardData.widgetCode) {
            return wizardData.widgetCode;
        } else {
            return getChecklistValue('widget-code');
        }
    };
    
    // Build the progress text in markdown format
    let progressText = `## Troubleshooting steps I already tried:

**Platform:** ${getChecklistValue('platform')}
**Plan:** ${getChecklistValue('plan')}
**Plan is compatible:** ${getChecklistStatus('plan-compatible')}
**Widget type:** ${getChecklistValue('widget-type')}
**Payouts are set up:** ${getChecklistStatus('payouts')}
**Campaign is published:** ${getChecklistStatus('campaign')}

**Library code:**
\`\`\`
${getLibraryCode()}
\`\`\`

**Website:** ${getChecklistValue('website')}
**Library code is installed:** ${getChecklistStatus('library-installed')}

**Widget code:**
\`\`\`
${getWidgetCode()}
\`\`\``;

    // Add platform-specific fields if they exist
    const shortcodeElement = document.getElementById('checklist-shortcode-item');
    if (shortcodeElement && shortcodeElement.style.display !== 'none') {
        const shortcodeValue = wizardData.shortcode || getChecklistValue('shortcode');
        progressText += `\n**Shortcode (WordPress):**\n\`\`\`\n${shortcodeValue}\n\`\`\``;
    }
    
    const widgetIdElement = document.getElementById('checklist-widget-id-item');
    if (widgetIdElement && widgetIdElement.style.display !== 'none') {
        const widgetIdValue = wizardData.wixWidgetId || getChecklistValue('widget-id');
        progressText += `\n**Widget ID (Wix):** \`${widgetIdValue}\``;
    }
    
    // Always include this last field
    progressText += `\n**Widget code is installed:** ${getChecklistStatus('widget-installed')}`;

    navigator.clipboard.writeText(progressText).then(() => {
        const originalText = buttonElement.innerHTML;
        buttonElement.innerHTML = '✅ Copied!';
        buttonElement.style.background = '#4CAF50';
        
        setTimeout(() => {
            buttonElement.innerHTML = originalText;
            buttonElement.style.background = '#9c27b0';
        }, 2000);
    });
}

// Widget code detection functions
function checkWidgetCode() {
    const code = document.getElementById('userWidgetCode').value.trim();
    const continueBtn = document.getElementById('widgetCodeContinue');
    const errorDiv = document.getElementById('regularWidgetCodeError');
    
    // Validate widget code
    const isValid = code && code.includes('givebutter-widget');
    
    // Show/hide error message
    if (code && !isValid) {
        errorDiv.style.display = 'block';
    } else {
        errorDiv.style.display = 'none';
    }
    
    // Enable/disable button
    if (isValid) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
        wizardData.widgetCode = code;
        
        // Extract widget ID and update checklist
        const idMatch = code.match(/id="([^"]+)"/);
        if (idMatch) {
            // Update checklist with full widget code
            updateChecklist('widget-code', code);
        }
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
    }
}

function proceedToWidgetSearch() {
    // Check if we already have website URL from library check
    if (wizardData.websiteUrl) {
        // Skip URL collection and go straight to widget inspection
        setupWidgetInspection();
        nextStep('step-widget-inspection');
    } else {
        // Need to collect website URL first
        nextStep('step-website-url');
    }
}

// WordPress widget code detection functions
        function checkWordpressWidgetCode() {
    const widgetCode = document.getElementById('userWidgetCodeWordpress').value.trim();
    const shortcode = document.getElementById('userShortcode').value.trim();
    const continueBtn = document.getElementById('wordpressWidgetCodeContinue');
    const widgetError = document.getElementById('widgetCodeError');
    const shortcodeError = document.getElementById('shortcodeError');
    
    // Validate widget code
    const widgetCodeValid = widgetCode && widgetCode.includes('givebutter-widget');
    if (widgetCode && !widgetCodeValid) {
        widgetError.style.display = 'block';
    } else {
        widgetError.style.display = 'none';
    }
    
    // Validate shortcode
    const shortcodeValid = shortcode && shortcode.includes('[givebutter');
    if (shortcode && !shortcodeValid) {
        shortcodeError.style.display = 'block';
    } else {
        shortcodeError.style.display = 'none';
    }
    
    // Enable button only if both are valid
    if (widgetCodeValid && shortcodeValid) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
        wizardData.widgetCode = widgetCode;
        wizardData.shortcode = shortcode;
        
            // Update checklist with full widget code
        updateChecklist('widget-code', widgetCode);
        updateChecklist('shortcode', shortcode);
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
    }
}

function checkWordpressShortcode() {
    // Call the same validation function since they both affect the continue button
    checkWordpressWidgetCode();
}

// Wix validation function
        function checkWixCodes() {
            const libraryCode = document.getElementById('wixLibraryCode').value.trim();
            const widgetId = document.getElementById('wixWidgetId').value.trim();
            const continueBtn = document.getElementById('wixCodesContinue');
            const libraryError = document.getElementById('wixLibraryCodeError');
            const widgetIdError = document.getElementById('wixWidgetIdError');
            
            // Validate library code
            const libraryValid = libraryCode && libraryCode.includes('widgets.givebutter.com');
            if (libraryCode && !libraryValid) {
                libraryError.style.display = 'block';
            } else {
                libraryError.style.display = 'none';
            }
            
            // Validate widget ID (6 characters, letters and numbers)
            const widgetIdValid = widgetId && /^[a-zA-Z0-9]{6}$/.test(widgetId);
            if (widgetId && !widgetIdValid) {
                widgetIdError.style.display = 'block';
            } else {
                widgetIdError.style.display = 'none';
            }
            
            // Enable button only if both are valid
            if (libraryValid && widgetIdValid) {
                continueBtn.disabled = false;
                continueBtn.style.opacity = '1';
                wizardData.wixLibraryCode = libraryCode;
                wizardData.wixWidgetId = widgetId;
                
                // Update checklist
                // Update checklist
                updateChecklist('library-code', libraryCode);
                updateChecklist('widget-id', widgetId);
            } else {
                continueBtn.disabled = true;
                continueBtn.style.opacity = '0.5';
            }
        }

function proceedToWordpressWidgetSearch() {
    // Check if we already have website URL from library check
    if (wizardData.websiteUrl) {
        // Skip URL collection and go straight to widget inspection
        setupWidgetInspection();
        nextStep('step-widget-inspection');
    } else {
        // Need to collect website URL first
        nextStep('step-website-url');
    }
}

function checkWidgetUrlInput() {
    const url = document.getElementById('widgetWebsiteUrl').value.trim();
    const continueBtn = document.getElementById('widgetUrlContinue');
    
    if (url) {
        continueBtn.disabled = false;
        continueBtn.style.opacity = '1';
    } else {
        continueBtn.disabled = true;
        continueBtn.style.opacity = '0.5';
    }
}

function proceedToWidgetInspection() {
    let url = document.getElementById('widgetWebsiteUrl').value.trim();
    
    // Add https:// if no protocol is present
    if (url && !url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
    }
    
    wizardData.websiteUrl = url;
    
    // Update checklist if not already set
    if (!document.getElementById('checklist-website').textContent.includes(url)) {
        updateChecklist('website', url);
    }
    
    // Route to appropriate inspection page
    if (wizardData.platform === 'wix') {
        setupWixInspection();
        nextStep('step-wix-inspection');
    } else {
        setupWidgetInspection();
        nextStep('step-widget-inspection');
    }
}

        // Initialize wizard
        updateNavButtons();
    </script>
</body>
</html>
